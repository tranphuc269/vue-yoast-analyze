{"version":3,"sources":["../../../../src/assessments/seo/TextCompetingLinksAssessment.js"],"names":["TextCompetingLinksAssessment","Assessment","constructor","config","defaultConfig","parameters","recommendedMaximum","scores","bad","urlTitle","urlCallToAction","identifier","_config","getResult","paper","researcher","i18n","assessmentResult","AssessmentResult","linkCount","getResearch","calculatedResult","calculateResult","setScore","score","setText","resultText","setHasMarks","isApplicable","hasText","hasKeyword","keyword","totalKeyword","sprintf","dgettext"],"mappings":";;;;;;AAAA;;AAEA;;;;AACA;;AACA;;;;;;AAEA;;;AAGA,MAAMA,4BAAN,SAA2CC,oBAA3C,CAAsD;AACrD;;;;;;;;;;AAUAC,aAAaC,SAAS,EAAtB,EAA2B;AAC1B;;AAEA,QAAMC,gBAAgB;AACrBC,eAAY;AACXC,wBAAoB;AADT,IADS;AAIrBC,WAAQ;AACPC,SAAK;AADE,IAJa;AAOrBC,aAAU,yCAAwB,oBAAxB,CAPW;AAQrBC,oBAAiB,yCAAwB,oBAAxB;AARI,GAAtB;;AAWA,OAAKC,UAAL,GAAkB,oBAAlB;AACA,OAAKC,OAAL,GAAe,qBAAOR,aAAP,EAAsBD,MAAtB,CAAf;AACA;;AAED;;;;;;;;;AASAU,WAAWC,KAAX,EAAkBC,UAAlB,EAA8BC,IAA9B,EAAqC;AACpC,QAAMC,mBAAmB,IAAIC,0BAAJ,EAAzB;;AAEA,OAAKC,SAAL,GAAiBJ,WAAWK,WAAX,CAAwB,mBAAxB,CAAjB;;AAEA,QAAMC,mBAAmB,KAAKC,eAAL,CAAsBN,IAAtB,CAAzB;;AAEA,MAAK,2BAAaK,gBAAb,CAAL,EAAuC;AACtC,UAAOJ,gBAAP;AACA;;AAEDA,mBAAiBM,QAAjB,CAA2BF,iBAAiBG,KAA5C;AACAP,mBAAiBQ,OAAjB,CAA0BJ,iBAAiBK,UAA3C;AACAT,mBAAiBU,WAAjB,CAA8B,KAA9B;;AAEA,SAAOV,gBAAP;AACA;;AAED;;;;;;;AAOAW,cAAcd,KAAd,EAAsB;AACrB,SAAOA,MAAMe,OAAN,MAAmBf,MAAMgB,UAAN,EAA1B;AACA;;AAED;;;;;;;AAOAR,iBAAiBN,IAAjB,EAAwB;AACvB,MAAK,KAAKG,SAAL,CAAeY,OAAf,CAAuBC,YAAvB,GAAsC,KAAKpB,OAAL,CAAaP,UAAb,CAAwBC,kBAAnE,EAAwF;AACvF,UAAO;AACNkB,WAAO,KAAKZ,OAAL,CAAaL,MAAb,CAAoBC,GADrB;AAENkB,gBAAYV,KAAKiB,OAAL;AACX;AACAjB,SAAKkB,QAAL,CACC,kBADD,EAEC,6BACA,gFADA,GAEA,wBAJD,CAFW,EAQX,KAAKtB,OAAL,CAAaH,QARF,EASX,KAAKG,OAAL,CAAaF,eATF,EAUX,MAVW;AAFN,IAAP;AAeA;AACD;AA5FoD;;kBA+FvCV,4B","file":"TextCompetingLinksAssessment.js","sourcesContent":["import { isUndefined, merge } from \"lodash-es\";\n\nimport Assessment from \"../../assessment\";\nimport { createAnchorOpeningTag } from \"../../helpers/shortlinker\";\nimport AssessmentResult from \"../../values/AssessmentResult\";\n\n/**\n * Assessment to check whether you're linking to a different page with the keyword from this page.\n */\nclass TextCompetingLinksAssessment extends Assessment {\n\t/**\n\t * Sets the identifier and the config.\n\t *\n\t * @param {Object} [config] The configuration to use.\n\t * @param {number} [config.parameters.recommendedMaximum] The recommended maximum number of links using the same keyword as this paper.\n\t * @param {string} [config.scores.bad] The score to return if there are more links with the same keyword than the recommended maximum.\n\t * @param {string} [config.url] The URL to the relevant article on Yoast.com.\n\t *\n\t * @returns {void}\n\t */\n\tconstructor( config = {} ) {\n\t\tsuper();\n\n\t\tconst defaultConfig = {\n\t\t\tparameters: {\n\t\t\t\trecommendedMaximum: 0,\n\t\t\t},\n\t\t\tscores: {\n\t\t\t\tbad: 2,\n\t\t\t},\n\t\t\turlTitle: createAnchorOpeningTag( \"https://yoa.st/34l\" ),\n\t\t\turlCallToAction: createAnchorOpeningTag( \"https://yoa.st/34m\" ),\n\t\t};\n\n\t\tthis.identifier = \"textCompetingLinks\";\n\t\tthis._config = merge( defaultConfig, config );\n\t}\n\n\t/**\n\t * Runs the linkCount module, based on this returns an assessment result with score.\n\t *\n\t * @param {Paper} paper The paper to use for the assessment.\n\t * @param {Researcher} researcher The researcher used for calling research.\n\t * @param {Jed} i18n The object used for translations.\n\t *\n\t * @returns {Object} The AssessmentResult.\n\t */\n\tgetResult( paper, researcher, i18n ) {\n\t\tconst assessmentResult = new AssessmentResult();\n\n\t\tthis.linkCount = researcher.getResearch( \"getLinkStatistics\" );\n\n\t\tconst calculatedResult = this.calculateResult( i18n );\n\n\t\tif ( isUndefined( calculatedResult ) ) {\n\t\t\treturn assessmentResult;\n\t\t}\n\n\t\tassessmentResult.setScore( calculatedResult.score );\n\t\tassessmentResult.setText( calculatedResult.resultText );\n\t\tassessmentResult.setHasMarks( false );\n\n\t\treturn assessmentResult;\n\t}\n\n\t/**\n\t * Determines if the assessment is applicable to the paper.\n\t *\n\t * @param {Paper} paper The paper to check\n\t *\n\t * @returns {boolean} Whether the paper has text and a keyword\n\t */\n\tisApplicable( paper ) {\n\t\treturn paper.hasText() && paper.hasKeyword();\n\t}\n\n\t/**\n\t * Returns a result based on the number of links.\n\t *\n\t * @param {Jed} i18n The object used for translations.\n\t *\n\t * @returns {Object} ResultObject with score and text.\n\t */\n\tcalculateResult( i18n ) {\n\t\tif ( this.linkCount.keyword.totalKeyword > this._config.parameters.recommendedMaximum ) {\n\t\t\treturn {\n\t\t\t\tscore: this._config.scores.bad,\n\t\t\t\tresultText: i18n.sprintf(\n\t\t\t\t\t/* Translators:  %1$s and %2$s expand to links on yoast.com, %3$s expands to the anchor end tag */\n\t\t\t\t\ti18n.dgettext(\n\t\t\t\t\t\t\"js-text-analysis\",\n\t\t\t\t\t\t\"%1$sLink keyphrase%3$s: \" +\n\t\t\t\t\t\t\"You're linking to another page with the words you want this page to rank for. \" +\n\t\t\t\t\t\t\"%2$sDon't do that%3$s!\"\n\t\t\t\t\t),\n\t\t\t\t\tthis._config.urlTitle,\n\t\t\t\t\tthis._config.urlCallToAction,\n\t\t\t\t\t\"</a>\"\n\t\t\t\t),\n\t\t\t};\n\t\t}\n\t}\n}\n\nexport default TextCompetingLinksAssessment;\n"]}