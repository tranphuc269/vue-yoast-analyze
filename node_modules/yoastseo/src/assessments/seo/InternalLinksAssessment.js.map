{"version":3,"sources":["../../../../src/assessments/seo/InternalLinksAssessment.js"],"names":["InternalLinksAssessment","Assessment","constructor","config","defaultConfig","parameters","recommendedMinimum","scores","allInternalFollow","someInternalFollow","noneInternalFollow","noInternal","urlTitle","urlCallToAction","identifier","_config","getResult","paper","researcher","i18n","linkStatistics","getResearch","assessmentResult","AssessmentResult","calculatedResult","calculateResult","setScore","score","setText","resultText","isApplicable","hasText","internalTotal","sprintf","dgettext","internalNofollow","internalDofollow"],"mappings":";;;;;;AAAA;;AAEA;;;;AACA;;AACA;;;;;;AAEA;;;AAGA,MAAMA,uBAAN,SAAsCC,oBAAtC,CAAiD;AAChD;;;;;;;;;;;;;AAaAC,aAAaC,SAAS,EAAtB,EAA2B;AAC1B;;AAEA,QAAMC,gBAAgB;AACrBC,eAAY;AACXC,wBAAoB;AADT,IADS;AAIrBC,WAAQ;AACPC,uBAAmB,CADZ;AAEPC,wBAAoB,CAFb;AAGPC,wBAAoB,CAHb;AAIPC,gBAAY;AAJL,IAJa;AAUrBC,aAAU,yCAAwB,oBAAxB,CAVW;AAWrBC,oBAAiB,yCAAwB,oBAAxB;AAXI,GAAtB;;AAcA,OAAKC,UAAL,GAAkB,eAAlB;AACA,OAAKC,OAAL,GAAe,qBAAOX,aAAP,EAAsBD,MAAtB,CAAf;AACA;;AAED;;;;;;;;;AASAa,WAAWC,KAAX,EAAkBC,UAAlB,EAA8BC,IAA9B,EAAqC;AACpC,OAAKC,cAAL,GAAsBF,WAAWG,WAAX,CAAwB,mBAAxB,CAAtB;AACA,QAAMC,mBAAmB,IAAIC,0BAAJ,EAAzB;;AAEA,QAAMC,mBAAmB,KAAKC,eAAL,CAAsBN,IAAtB,CAAzB;AACAG,mBAAiBI,QAAjB,CAA2BF,iBAAiBG,KAA5C;AACAL,mBAAiBM,OAAjB,CAA0BJ,iBAAiBK,UAA3C;;AAEA,SAAOP,gBAAP;AACA;;AAED;;;;;;;AAOAQ,cAAcb,KAAd,EAAsB;AACrB,SAAOA,MAAMc,OAAN,EAAP;AACA;;AAED;;;;;;;AAOAN,iBAAiBN,IAAjB,EAAwB;AACvB,MAAK,KAAKC,cAAL,CAAoBY,aAApB,KAAsC,CAA3C,EAA+C;AAC9C,UAAO;AACNL,WAAO,KAAKZ,OAAL,CAAaR,MAAb,CAAoBI,UADrB;AAENkB,gBAAYV,KAAKc,OAAL;AACX;AACAd,SAAKe,QAAL,CAAe,kBAAf,EAAmC,6BAClC,uEADD,CAFW,EAIX,KAAKnB,OAAL,CAAaH,QAJF,EAKX,KAAKG,OAAL,CAAaF,eALF,EAMX,MANW;AAFN,IAAP;AAWA;;AAED,MAAK,KAAKO,cAAL,CAAoBe,gBAApB,KAAyC,KAAKf,cAAL,CAAoBY,aAAlE,EAAkF;AACjF,UAAO;AACNL,WAAO,KAAKZ,OAAL,CAAaR,MAAb,CAAoBG,kBADrB;AAENmB,gBAAYV,KAAKc,OAAL;AACX;AACAd,SAAKe,QAAL,CAAe,kBAAf,EAAmC,6BAClC,2FADD,CAFW,EAIX,KAAKnB,OAAL,CAAaH,QAJF,EAKX,KAAKG,OAAL,CAAaF,eALF,EAMX,MANW;AAFN,IAAP;AAWA;;AAED,MAAK,KAAKO,cAAL,CAAoBgB,gBAApB,KAAyC,KAAKhB,cAAL,CAAoBY,aAAlE,EAAkF;AACjF,UAAO;AACNL,WAAO,KAAKZ,OAAL,CAAaR,MAAb,CAAoBC,iBADrB;AAENqB,gBAAYV,KAAKc,OAAL;AACX;AACAd,SAAKe,QAAL,CAAe,kBAAf,EAAmC,mEAAnC,CAFW,EAGX,KAAKnB,OAAL,CAAaH,QAHF,EAIX,MAJW;AAFN,IAAP;AASA;AACD,SAAO;AACNe,UAAO,KAAKZ,OAAL,CAAaR,MAAb,CAAoBE,kBADrB;AAENoB,eAAYV,KAAKc,OAAL;AACX;AACAd,QAAKe,QAAL,CACC,kBADD,EAEC,qGAFD,CAFW,EAMX,KAAKnB,OAAL,CAAaH,QANF,EAOX,MAPW;AAFN,GAAP;AAYA;AA7H+C;;kBAgIlCZ,uB","file":"InternalLinksAssessment.js","sourcesContent":["import { merge } from \"lodash-es\";\n\nimport Assessment from \"../../assessment\";\nimport { createAnchorOpeningTag } from \"../../helpers/shortlinker\";\nimport AssessmentResult from \"../../values/AssessmentResult\";\n\n/**\n * Assessment to check whether the text has internal links and whether they are followed or no-followed.\n */\nclass InternalLinksAssessment extends Assessment {\n\t/**\n\t * Sets the identifier and the config.\n\t *\n\t * @param {Object} [config] The configuration to use.\n\t * @param {number} [config.parameters.recommendedMinimum] The recommended minimum number of internal links in the text.\n\t * @param {number} [config.scores.allInternalFollow] The score to return if all internal links are do-follow.\n\t * @param {number} [config.scores.someInternalFollow] The score to return if some but not all internal links are do-follow.\n\t * @param {number} [config.scores.noneInternalFollow] The score to return if all internal links are no-follow.\n\t * @param {number} [config.scores.noInternal] The score to return if there are no internal links.\n\t * @param {string} [config.url] The URL to the relevant KB article.\n\t *\n\t * @returns {void}\n\t */\n\tconstructor( config = {} ) {\n\t\tsuper();\n\n\t\tconst defaultConfig = {\n\t\t\tparameters: {\n\t\t\t\trecommendedMinimum: 1,\n\t\t\t},\n\t\t\tscores: {\n\t\t\t\tallInternalFollow: 9,\n\t\t\t\tsomeInternalFollow: 8,\n\t\t\t\tnoneInternalFollow: 7,\n\t\t\t\tnoInternal: 3,\n\t\t\t},\n\t\t\turlTitle: createAnchorOpeningTag( \"https://yoa.st/33z\" ),\n\t\t\turlCallToAction: createAnchorOpeningTag( \"https://yoa.st/34a\" ),\n\t\t};\n\n\t\tthis.identifier = \"internalLinks\";\n\t\tthis._config = merge( defaultConfig, config );\n\t}\n\n\t/**\n\t * Runs the getLinkStatistics module, based on this returns an assessment result with score.\n\t *\n\t * @param {Paper} paper The paper to use for the assessment.\n\t * @param {Researcher} researcher The researcher used for calling research.\n\t * @param {Jed} i18n The object used for translations.\n\t *\n\t * @returns {AssessmentResult} The result of the assessment.\n\t */\n\tgetResult( paper, researcher, i18n ) {\n\t\tthis.linkStatistics = researcher.getResearch( \"getLinkStatistics\" );\n\t\tconst assessmentResult = new AssessmentResult();\n\n\t\tconst calculatedResult = this.calculateResult( i18n );\n\t\tassessmentResult.setScore( calculatedResult.score );\n\t\tassessmentResult.setText( calculatedResult.resultText );\n\n\t\treturn assessmentResult;\n\t}\n\n\t/**\n\t * Checks if assessment is applicable to the paper.\n\t *\n\t * @param {Paper} paper The paper to be analyzed.\n\t *\n\t * @returns {boolean} Whether the paper has text.\n\t */\n\tisApplicable( paper ) {\n\t\treturn paper.hasText();\n\t}\n\n\t/**\n\t * Returns a score and text based on the linkStatistics object.\n\t *\n\t * @param {Jed} i18n The object used for translations.\n\t *\n\t * @returns {Object} ResultObject with score and text\n\t */\n\tcalculateResult( i18n ) {\n\t\tif ( this.linkStatistics.internalTotal === 0 ) {\n\t\t\treturn {\n\t\t\t\tscore: this._config.scores.noInternal,\n\t\t\t\tresultText: i18n.sprintf(\n\t\t\t\t\t/* Translators: %1$s and %2$s expand to links on yoast.com, %3$s expands to the anchor end tag */\n\t\t\t\t\ti18n.dgettext( \"js-text-analysis\", \"%1$sInternal links%3$s: \" +\n\t\t\t\t\t\t\"No internal links appear in this page, %2$smake sure to add some%3$s!\" ),\n\t\t\t\t\tthis._config.urlTitle,\n\t\t\t\t\tthis._config.urlCallToAction,\n\t\t\t\t\t\"</a>\"\n\t\t\t\t),\n\t\t\t};\n\t\t}\n\n\t\tif ( this.linkStatistics.internalNofollow === this.linkStatistics.internalTotal ) {\n\t\t\treturn {\n\t\t\t\tscore: this._config.scores.noneInternalFollow,\n\t\t\t\tresultText: i18n.sprintf(\n\t\t\t\t\t/* Translators: %1$s and %2$s expand to links on yoast.com, %3$s expands to the anchor end tag */\n\t\t\t\t\ti18n.dgettext( \"js-text-analysis\", \"%1$sInternal links%3$s: \" +\n\t\t\t\t\t\t\"The internal links in this page are all nofollowed. %2$sAdd some good internal links%3$s.\" ),\n\t\t\t\t\tthis._config.urlTitle,\n\t\t\t\t\tthis._config.urlCallToAction,\n\t\t\t\t\t\"</a>\"\n\t\t\t\t),\n\t\t\t};\n\t\t}\n\n\t\tif ( this.linkStatistics.internalDofollow === this.linkStatistics.internalTotal ) {\n\t\t\treturn {\n\t\t\t\tscore: this._config.scores.allInternalFollow,\n\t\t\t\tresultText: i18n.sprintf(\n\t\t\t\t\t/* Translators: %1$s expands to a link on yoast.com, %2$s expands to the anchor end tag */\n\t\t\t\t\ti18n.dgettext( \"js-text-analysis\", \"%1$sInternal links%2$s: You have enough internal links. Good job!\" ),\n\t\t\t\t\tthis._config.urlTitle,\n\t\t\t\t\t\"</a>\"\n\t\t\t\t),\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\tscore: this._config.scores.someInternalFollow,\n\t\t\tresultText: i18n.sprintf(\n\t\t\t\t/* Translators: %1$s expands to a link on yoast.com, %2$s expands to the anchor end tag */\n\t\t\t\ti18n.dgettext(\n\t\t\t\t\t\"js-text-analysis\",\n\t\t\t\t\t\"%1$sInternal links%2$s: There are both nofollowed and normal internal links on this page. Good job!\"\n\t\t\t\t),\n\t\t\t\tthis._config.urlTitle,\n\t\t\t\t\"</a>\",\n\t\t\t),\n\t\t};\n\t}\n}\n\nexport default InternalLinksAssessment;\n"]}