{"version":3,"sources":["../../../../src/assessments/seo/MetaDescriptionKeywordAssessment.js"],"names":["MetaDescriptionKeywordAssessment","Assessment","constructor","config","defaultConfig","parameters","recommendedMinimum","scores","good","ok","bad","urlTitle","urlCallToAction","identifier","_config","getResult","paper","researcher","i18n","_keyphraseCounts","getResearch","assessmentResult","AssessmentResult","calculatedResult","calculateResult","setScore","score","setText","resultText","sprintf","dgettext","isApplicable","hasKeyword","hasDescription"],"mappings":";;;;;;AAAA;;AAEA;;;;AACA;;AACA;;;;;;AAEA;;;AAGA,MAAMA,gCAAN,SAA+CC,oBAA/C,CAA0D;AACzD;;;;;;;;;;;AAWAC,aAAaC,SAAS,EAAtB,EAA2B;AAC1B;;AAEA,QAAMC,gBAAgB;AACrBC,eAAY;AACXC,wBAAoB;AADT,IADS;AAIrBC,WAAQ;AACPC,UAAM,CADC;AAEPC,QAAI,CAFG;AAGPC,SAAK;AAHE,IAJa;AASrBC,aAAU,yCAAwB,oBAAxB,CATW;AAUrBC,oBAAiB,yCAAwB,oBAAxB;AAVI,GAAtB;;AAaA,OAAKC,UAAL,GAAkB,wBAAlB;AACA,OAAKC,OAAL,GAAe,qBAAOV,aAAP,EAAsBD,MAAtB,CAAf;AACA;;AAED;;;;;;;;;AASAY,WAAWC,KAAX,EAAkBC,UAAlB,EAA8BC,IAA9B,EAAqC;AACpC,OAAKC,gBAAL,GAAwBF,WAAWG,WAAX,CAAwB,wBAAxB,CAAxB;AACA,QAAMC,mBAAmB,IAAIC,0BAAJ,EAAzB;AACA,QAAMC,mBAAmB,KAAKC,eAAL,CAAsBN,IAAtB,CAAzB;;AAEAG,mBAAiBI,QAAjB,CAA2BF,iBAAiBG,KAA5C;AACAL,mBAAiBM,OAAjB,CAA0BJ,iBAAiBK,UAA3C;;AAEA,SAAOP,gBAAP;AACA;;AAED;;;;;;;AAOAG,iBAAiBN,IAAjB,EAAwB;AACvB;AACA,MAAK,KAAKC,gBAAL,KAA0B,CAA1B,IAA+B,KAAKA,gBAAL,KAA0B,CAA9D,EAAkE;AACjE,UAAO;AACNO,WAAO,KAAKZ,OAAL,CAAaP,MAAb,CAAoBC,IADrB;AAENoB,gBAAYV,KAAKW,OAAL;AACX;AACAX,SAAKY,QAAL,CACC,kBADD,EAEC,wGAFD,CAFW,EAMX,KAAKhB,OAAL,CAAaH,QANF,EAOX,MAPW;AAFN,IAAP;AAYA;;AAED;AACA,MAAK,KAAKQ,gBAAL,IAAyB,CAA9B,EAAkC;AACjC,UAAO;AACNO,WAAO,KAAKZ,OAAL,CAAaP,MAAb,CAAoBG,GADrB;AAENkB,gBAAYV,KAAKW,OAAL;AACX;;;;;;AAMAX,SAAKY,QAAL,CACC,kBADD,EAEC,oGACA,mEAHD,CAPW,EAYX,KAAKhB,OAAL,CAAaH,QAZF,EAaX,MAbW,EAcX,KAAKQ,gBAdM,EAeX,KAAKL,OAAL,CAAaF,eAfF,EAgBX,MAhBW;AAFN,IAAP;AAqBA;;AAED;AACA,SAAO;AACNc,UAAO,KAAKZ,OAAL,CAAaP,MAAb,CAAoBG,GADrB;AAENkB,eAAYV,KAAKW,OAAL;AACX;;;;;AAKAX,QAAKY,QAAL,CACC,kBADD,EAEC,qFACA,0DAHD,CANW,EAWX,KAAKhB,OAAL,CAAaH,QAXF,EAYX,MAZW,EAaX,KAAKG,OAAL,CAAaF,eAbF,EAcX,MAdW;AAFN,GAAP;AAmBA;;AAED;;;;;;;AAOAmB,cAAcf,KAAd,EAAsB;AACrB,SAAOA,MAAMgB,UAAN,MAAsBhB,MAAMiB,cAAN,EAA7B;AACA;AApIwD;;kBAuI3CjC,gC","file":"MetaDescriptionKeywordAssessment.js","sourcesContent":["import { merge } from \"lodash-es\";\n\nimport Assessment from \"../../assessment\";\nimport { createAnchorOpeningTag } from \"../../helpers/shortlinker\";\nimport AssessmentResult from \"../../values/AssessmentResult\";\n\n/**\n * Assessment for checking the keyword matches in the meta description.\n */\nclass MetaDescriptionKeywordAssessment extends Assessment {\n\t/**\n\t * Sets the identifier and the config.\n\t *\n\t * @param {Object} [config] The configuration to use.\n\t * @param {number} [config.parameters.recommendedMinimum] The recommended minimum of keyword occurrences in the meta description.\n\t * @param {number} [config.scores.good] The score to return if there are enough keyword occurrences in the meta description.\n\t * @param {number} [config.scores.bad] The score to return if there aren't enough keyword occurrences in the meta description.\n\t * @param {string} [config.url] The URL to the relevant article on Yoast.com.\n\t *\n\t * @returns {void}\n\t */\n\tconstructor( config = {} ) {\n\t\tsuper();\n\n\t\tconst defaultConfig = {\n\t\t\tparameters: {\n\t\t\t\trecommendedMinimum: 1,\n\t\t\t},\n\t\t\tscores: {\n\t\t\t\tgood: 9,\n\t\t\t\tok: 6,\n\t\t\t\tbad: 3,\n\t\t\t},\n\t\t\turlTitle: createAnchorOpeningTag( \"https://yoa.st/33k\" ),\n\t\t\turlCallToAction: createAnchorOpeningTag( \"https://yoa.st/33l\" ),\n\t\t};\n\n\t\tthis.identifier = \"metaDescriptionKeyword\";\n\t\tthis._config = merge( defaultConfig, config );\n\t}\n\n\t/**\n\t * Runs the metaDescriptionKeyword researcher and based on this, returns an assessment result with score.\n\t *\n\t * @param {Paper}      paper      The paper to use for the assessment.\n\t * @param {Researcher} researcher The researcher used for calling research.\n\t * @param {Jed}        i18n       The object used for translations.\n\t *\n\t * @returns {AssessmentResult} The assessment result.\n\t */\n\tgetResult( paper, researcher, i18n ) {\n\t\tthis._keyphraseCounts = researcher.getResearch( \"metaDescriptionKeyword\" );\n\t\tconst assessmentResult = new AssessmentResult();\n\t\tconst calculatedResult = this.calculateResult( i18n );\n\n\t\tassessmentResult.setScore( calculatedResult.score );\n\t\tassessmentResult.setText( calculatedResult.resultText );\n\n\t\treturn assessmentResult;\n\t}\n\n\t/**\n\t * Returns the result object based on the number of keyword matches in the meta description.\n\t *\n\t * @param {Jed} i18n The object used for translations.\n\t *\n\t * @returns {Object} Result object with score and text.\n\t */\n\tcalculateResult( i18n ) {\n\t\t// GOOD result when the meta description contains a keyphrase or synonym 1 or 2 times.\n\t\tif ( this._keyphraseCounts === 1 || this._keyphraseCounts === 2 ) {\n\t\t\treturn {\n\t\t\t\tscore: this._config.scores.good,\n\t\t\t\tresultText: i18n.sprintf(\n\t\t\t\t\t/* Translators: %1$s expands to a link on yoast.com, %2$s expands to the anchor end tag. */\n\t\t\t\t\ti18n.dgettext(\n\t\t\t\t\t\t\"js-text-analysis\",\n\t\t\t\t\t\t\"%1$sKeyphrase in meta description%2$s: Keyphrase or synonym appear in the meta description. Well done!\",\n\t\t\t\t\t),\n\t\t\t\t\tthis._config.urlTitle,\n\t\t\t\t\t\"</a>\"\n\t\t\t\t),\n\t\t\t};\n\t\t}\n\n\t\t// BAD if the description contains every keyword term more than twice.\n\t\tif ( this._keyphraseCounts >= 3 ) {\n\t\t\treturn {\n\t\t\t\tscore: this._config.scores.bad,\n\t\t\t\tresultText: i18n.sprintf(\n\t\t\t\t\t/**\n\t\t\t\t\t * Translators:\n\t\t\t\t\t * %1$s expands to a link on yoast.com, %2$s expands to the anchor end tag,\n\t\t\t\t\t * %3$s expands to the number of sentences containing the keyphrase,\n\t\t\t\t\t * %4$s expands to a link on yoast.com, %5$s expands to the anchor end tag.\n\t\t\t\t\t */\n\t\t\t\t\ti18n.dgettext(\n\t\t\t\t\t\t\"js-text-analysis\",\n\t\t\t\t\t\t\"%1$sKeyphrase in meta description%2$s: The meta description contains the keyphrase %3$s times, \" +\n\t\t\t\t\t\t\"which is over the advised maximum of 2 times. %4$sLimit that%5$s!\",\n\t\t\t\t\t),\n\t\t\t\t\tthis._config.urlTitle,\n\t\t\t\t\t\"</a>\",\n\t\t\t\t\tthis._keyphraseCounts,\n\t\t\t\t\tthis._config.urlCallToAction,\n\t\t\t\t\t\"</a>\"\n\t\t\t\t),\n\t\t\t};\n\t\t}\n\n\t\t// BAD if the keyphrases is not contained in the meta description.\n\t\treturn {\n\t\t\tscore: this._config.scores.bad,\n\t\t\tresultText: i18n.sprintf(\n\t\t\t\t/**\n\t\t\t\t * Translators:\n\t\t\t\t * %1$s expands to a link on yoast.com, %2$s expands to the anchor end tag.\n\t\t\t\t * %3$s expands to a link on yoast.com, %4$s expands to the anchor end tag.\n\t\t\t\t */\n\t\t\t\ti18n.dgettext(\n\t\t\t\t\t\"js-text-analysis\",\n\t\t\t\t\t\"%1$sKeyphrase in meta description%2$s: The meta description has been specified, \" +\n\t\t\t\t\t\"but it does not contain the keyphrase. %3$sFix that%4$s!\"\n\t\t\t\t),\n\t\t\t\tthis._config.urlTitle,\n\t\t\t\t\"</a>\",\n\t\t\t\tthis._config.urlCallToAction,\n\t\t\t\t\"</a>\"\n\t\t\t),\n\t\t};\n\t}\n\n\t/**\n\t * Checks whether the paper has a keyword and a meta description.\n\t *\n\t * @param {Paper} paper The paper to use for the assessment.\n\t *\n\t * @returns {boolean} True if the paper has a keyword and a meta description.\n\t */\n\tisApplicable( paper ) {\n\t\treturn paper.hasKeyword() && paper.hasDescription();\n\t}\n}\n\nexport default MetaDescriptionKeywordAssessment;\n"]}