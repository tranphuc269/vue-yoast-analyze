{"version":3,"sources":["../../../../src/assessments/seo/MetaDescriptionLengthAssessment.js"],"names":["maximumMetaDescriptionLength","Config","maxMeta","MetaDescriptionLengthAssessment","Assessment","constructor","config","defaultConfig","recommendedMaximumLength","maximumLength","scores","noMetaDescription","tooLong","tooShort","correctLength","urlTitle","urlCallToAction","identifier","_config","getMaximumLength","getResult","paper","researcher","i18n","descriptionLength","getResearch","assessmentResult","AssessmentResult","setScore","calculateScore","setText","translateScore","max","actual","sprintf","dgettext"],"mappings":"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","file":"MetaDescriptionLengthAssessment.js","sourcesContent":["import { merge } from \"lodash-es\";\nimport Assessment from \"../../assessment\";\nimport Config from \"../../config/config\";\nimport { createAnchorOpeningTag } from \"../../helpers/shortlinker\";\nimport AssessmentResult from \"../../values/AssessmentResult\";\n\nconst maximumMetaDescriptionLength = Config.maxMeta;\n\n/**\n * Assessment for calculating the length of the meta description.\n */\nexport default class MetaDescriptionLengthAssessment extends Assessment {\n\t/**\n\t * Sets the identifier and the config.\n\t *\n\t * @param {Object} [config] The configuration to use.\n\t *\n\t * @returns {void}\n\t */\n\tconstructor( config = {} ) {\n\t\tsuper();\n\n\t\tconst defaultConfig = {\n\t\t\trecommendedMaximumLength: 120,\n\t\t\tmaximumLength: maximumMetaDescriptionLength,\n\t\t\tscores: {\n\t\t\t\tnoMetaDescription: 1,\n\t\t\t\ttooLong: 6,\n\t\t\t\ttooShort: 6,\n\t\t\t\tcorrectLength: 9,\n\t\t\t},\n\t\t\turlTitle: createAnchorOpeningTag( \"https://yoa.st/34d\" ),\n\t\t\turlCallToAction: createAnchorOpeningTag( \"https://yoa.st/34e\" ),\n\t\t};\n\n\t\tthis.identifier = \"metaDescriptionLength\";\n\t\tthis._config = merge( defaultConfig, config );\n\t}\n\n\t/**\n\t * Returns the maximum length.\n\t *\n\t * @returns {number} The maximum length.\n\t */\n\tgetMaximumLength() {\n\t\treturn this._config.maximumLength;\n\t}\n\n\t/**\n\t * Runs the metaDescriptionLength module, based on this returns an assessment result with score.\n\t *\n\t * @param {Paper} paper The paper to use for the assessment.\n\t * @param {Researcher} researcher The researcher used for calling research.\n\t * @param {Jed} i18n The object used for translations\n\t *\n\t * @returns {AssessmentResult} The assessment result.\n\t */\n\tgetResult( paper, researcher, i18n ) {\n\t\tconst descriptionLength = researcher.getResearch( \"metaDescriptionLength\" );\n\t\tconst assessmentResult = new AssessmentResult();\n\n\t\tassessmentResult.setScore( this.calculateScore( descriptionLength ) );\n\t\tassessmentResult.setText( this.translateScore( descriptionLength, i18n ) );\n\n\t\t// Max and actual are used in the snippet editor progress bar.\n\t\tassessmentResult.max = this._config.maximumLength;\n\t\tassessmentResult.actual = descriptionLength;\n\n\t\treturn assessmentResult;\n\t}\n\n\t/**\n\t * Returns the score for the descriptionLength.\n\t *\n\t * @param {number} descriptionLength The length of the metadescription.\n\t *\n\t * @returns {number} The calculated score.\n\t */\n\tcalculateScore( descriptionLength ) {\n\t\tif ( descriptionLength === 0 ) {\n\t\t\treturn this._config.scores.noMetaDescription;\n\t\t}\n\n\t\tif ( descriptionLength <= this._config.recommendedMaximumLength ) {\n\t\t\treturn this._config.scores.tooShort;\n\t\t}\n\n\t\tif ( descriptionLength > this._config.maximumLength ) {\n\t\t\treturn this._config.scores.tooLong;\n\t\t}\n\n\t\tif ( descriptionLength >= this._config.recommendedMaximumLength && descriptionLength <= this._config.maximumLength ) {\n\t\t\treturn this._config.scores.correctLength;\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\t/**\n\t * Translates the descriptionLength to a message the user can understand.\n\t *\n\t * @param {number} descriptionLength The length of the metadescription.\n\t * @param {object} i18n The object used for translations.\n\t *\n\t * @returns {string} The translated string.\n\t */\n\ttranslateScore( descriptionLength, i18n ) {\n\t\tif ( descriptionLength === 0 ) {\n\t\t\treturn i18n.sprintf(\n\t\t\t\t/* Translators:  %1$s and %2$s expand to a links on yoast.com, %3$s expands to the anchor end tag */\n\t\t\t\ti18n.dgettext( \"js-text-analysis\", \"%1$sMeta description length%3$s:  No meta description has been specified. \" +\n\t\t\t\t\t\"Search engines will display copy from the page instead. %2$sMake sure to write one%3$s!\" ),\n\t\t\t\tthis._config.urlTitle,\n\t\t\t\tthis._config.urlCallToAction,\n\t\t\t\t\"</a>\"\n\t\t\t);\n\t\t}\n\n\t\tif ( descriptionLength <= this._config.recommendedMaximumLength ) {\n\t\t\treturn i18n.sprintf(\n\t\t\t\t/* Translators: %1$s and %2$s expand to links on yoast.com, %3$s expands to the anchor end tag,\n\t\t\t\t%4$d expands to the number of characters in the meta description, %5$d expands to\n\t\t\t\tthe total available number of characters in the meta description */\n\t\t\t\ti18n.dgettext( \"js-text-analysis\", \"%1$sMeta description length%3$s: The meta description is too short (under %4$d characters). \" +\n\t\t\t\t\"Up to %5$d characters are available. %2$sUse the space%3$s!\" ),\n\t\t\t\tthis._config.urlTitle,\n\t\t\t\tthis._config.urlCallToAction,\n\t\t\t\t\"</a>\",\n\t\t\t\tthis._config.recommendedMaximumLength,\n\t\t\t\tthis._config.maximumLength\n\t\t\t);\n\t\t}\n\n\t\tif ( descriptionLength > this._config.maximumLength ) {\n\t\t\treturn i18n.sprintf(\n\t\t\t\t/* Translators: %1$s and %2$s expand to links on yoast.com, %3$s expands to the anchor end tag,\n\t\t\t\t%4$d expands to\tthe total available number of characters in the meta description */\n\t\t\t\ti18n.dgettext( \"js-text-analysis\", \"%1$sMeta description length%3$s: The meta description is over %4$d characters. \" +\n\t\t\t\t\"To ensure the entire description will be visible, %2$syou should reduce the length%3$s!\" ),\n\t\t\t\tthis._config.urlTitle,\n\t\t\t\tthis._config.urlCallToAction,\n\t\t\t\t\"</a>\",\n\t\t\t\tthis._config.maximumLength\n\t\t\t);\n\t\t}\n\n\t\tif ( descriptionLength >= this._config.recommendedMaximumLength && descriptionLength <= this._config.maximumLength ) {\n\t\t\treturn i18n.sprintf(\n\t\t\t\t/* Translators:  %1$s expands to a link on yoast.com, %2$s expands to the anchor end tag */\n\t\t\t\ti18n.dgettext( \"js-text-analysis\", \"%1$sMeta description length%2$s: Well done!\" ),\n\t\t\t\tthis._config.urlTitle,\n\t\t\t\t\"</a>\"\n\t\t\t);\n\t\t}\n\t}\n}\n"]}