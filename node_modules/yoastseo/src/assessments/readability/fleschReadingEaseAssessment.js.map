{"version":3,"sources":["../../../../src/assessments/readability/fleschReadingEaseAssessment.js"],"names":["availableLanguages","FleschReadingEaseAssessment","Assessment","constructor","config","defaultConfig","urlTitle","urlCallToAction","identifier","_config","getResult","paper","researcher","i18n","fleschReadingResult","getResearch","isApplicable","assessmentResult","AssessmentResult","calculatedResult","calculateResult","setScore","score","setText","resultText","feedback","note","dgettext","borders","veryEasy","scores","easy","fairlyEasy","okay","fairlyDifficult","difficult","veryDifficult","sprintf","isLanguageAvailable","getLocale","hasText"],"mappings":"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","file":"fleschReadingEaseAssessment.js","sourcesContent":["import { inRange, merge } from \"lodash-es\";\n\nimport Assessment from \"../../assessment\";\nimport getLanguageAvailability from \"../../helpers/getLanguageAvailability\";\nimport { createAnchorOpeningTag } from \"../../helpers/shortlinker\";\nimport AssessmentResult from \"../../values/AssessmentResult\";\n\nconst availableLanguages = [ \"en\", \"nl\", \"de\", \"it\", \"ru\", \"fr\", \"es\", \"pt\" ];\n\n/**\n * Assessment to check how readable the text is, based on the Flesch reading ease test.\n */\nclass FleschReadingEaseAssessment extends Assessment {\n\t/**\n\t * Sets the identifier and the config.\n\t *\n\t * @param {Object} config The configuration to use.\n\t * @returns {void}\n\t */\n\tconstructor( config ) {\n\t\tsuper();\n\n\t\tconst defaultConfig = {\n\t\t\turlTitle: createAnchorOpeningTag( \"https://yoa.st/34r\" ),\n\t\t\turlCallToAction: createAnchorOpeningTag( \"https://yoa.st/34s\" ),\n\t\t};\n\n\t\tthis.identifier = \"fleschReadingEase\";\n\t\tthis._config = merge( defaultConfig, config );\n\t}\n\n\t/**\n\t * The assessment that runs the FleschReading on the paper.\n\t *\n\t * @param {Object} paper The paper to run this assessment on.\n\t * @param {Object} researcher The researcher used for the assessment.\n\t * @param {Object} i18n The i18n-object used for parsing translations.\n\t *\n\t * @returns {Object} An assessmentResult with the score and formatted text.\n\t */\n\tgetResult( paper, researcher, i18n ) {\n\t\tthis.fleschReadingResult = researcher.getResearch( \"calculateFleschReading\" );\n\t\tif ( this.isApplicable( paper ) ) {\n\t\t\tconst assessmentResult =  new AssessmentResult( i18n );\n\t\t\tconst calculatedResult = this.calculateResult( i18n );\n\t\t\tassessmentResult.setScore( calculatedResult.score );\n\t\t\tassessmentResult.setText( calculatedResult.resultText );\n\n\t\t\treturn assessmentResult;\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t * Calculates the assessment result based on the fleschReadingScore.\n\t *\n\t * @param {Object} i18n The i18n-object used for parsing translations.\n\t *\n\t * @returns {Object} Object with score and resultText.\n\t */\n\tcalculateResult( i18n ) {\n\t\t// Results must be between 0 and 100;\n\t\tif ( this.fleschReadingResult < 0 ) {\n\t\t\tthis.fleschReadingResult = 0;\n\t\t}\n\n\t\tif ( this.fleschReadingResult > 100 ) {\n\t\t\tthis.fleschReadingResult = 100;\n\t\t}\n\n\t\tlet score = 0;\n\t\tlet feedback = \"\";\n\t\tlet note = i18n.dgettext( \"js-text-analysis\", \"Good job!\" );\n\n\t\tif ( this.fleschReadingResult >= this._config.borders.veryEasy ) {\n\t\t\tscore = this._config.scores.veryEasy;\n\t\t\tfeedback = i18n.dgettext( \"js-text-analysis\", \"very easy\" );\n\t\t} else if ( inRange( this.fleschReadingResult, this._config.borders.easy, this._config.borders.veryEasy ) ) {\n\t\t\tscore = this._config.scores.easy;\n\t\t\tfeedback = i18n.dgettext( \"js-text-analysis\", \"easy\" );\n\t\t} else if ( inRange( this.fleschReadingResult, this._config.borders.fairlyEasy, this._config.borders.easy ) ) {\n\t\t\tscore = this._config.scores.fairlyEasy;\n\t\t\tfeedback = i18n.dgettext( \"js-text-analysis\", \"fairly easy\" );\n\t\t} else if ( inRange( this.fleschReadingResult, this._config.borders.okay, this._config.borders.fairlyEasy ) ) {\n\t\t\tscore = this._config.scores.okay;\n\t\t\tfeedback = i18n.dgettext( \"js-text-analysis\", \"ok\" );\n\t\t} else if ( inRange( this.fleschReadingResult, this._config.borders.fairlyDifficult, this._config.borders.okay ) ) {\n\t\t\tscore = this._config.scores.fairlyDifficult;\n\t\t\tfeedback = i18n.dgettext( \"js-text-analysis\", \"fairly difficult\" );\n\t\t\tnote = i18n.dgettext( \"js-text-analysis\", \"Try to make shorter sentences to improve readability\" );\n\t\t} else if ( inRange( this.fleschReadingResult, this._config.borders.difficult, this._config.borders.fairlyDifficult ) ) {\n\t\t\tscore = this._config.scores.difficult;\n\t\t\tfeedback = i18n.dgettext( \"js-text-analysis\", \"difficult\" );\n\t\t\tnote = i18n.dgettext( \"js-text-analysis\", \"Try to make shorter sentences, using less difficult words to improve readability\" );\n\t\t} else {\n\t\t\tscore = this._config.scores.veryDifficult;\n\t\t\tfeedback = i18n.dgettext( \"js-text-analysis\", \"very difficult\" );\n\t\t\tnote = i18n.dgettext( \"js-text-analysis\", \"Try to make shorter sentences, using less difficult words to improve readability\" );\n\t\t}\n\n\t\t// If the score is good, add a \"Good job\" message without a link to the Call-to-action article.\n\t\tif ( score >= this._config.scores.okay ) {\n\t\t\treturn {\n\t\t\t\tscore: score,\n\t\t\t\tresultText: i18n.sprintf(\n\t\t\t\t\t/* Translators: %1$s expands to a link on yoast.com,\n\t\t\t\t\t\t%2$s to the anchor end tag,\n\t\t\t\t\t\t%3$s expands to the numeric Flesch reading ease score,\n\t\t\t\t\t\t%4$s to the easiness of reading,\n\t\t\t\t\t\t%5$s expands to a call to action based on the score */\n\t\t\t\t\ti18n.dgettext(\n\t\t\t\t\t\t\"js-text-analysis\",\n\t\t\t\t\t\t\"%1$sFlesch Reading Ease%2$s: The copy scores %3$s in the test, which is considered %4$s to read. %5$s\"\n\t\t\t\t\t),\n\t\t\t\t\tthis._config.urlTitle,\n\t\t\t\t\t\"</a>\",\n\t\t\t\t\tthis.fleschReadingResult,\n\t\t\t\t\tfeedback,\n\t\t\t\t\tnote,\n\t\t\t\t),\n\t\t\t};\n\t\t}\n\t\t// If the score is not good, add a Call-to-action message with a link to the Call-to-action article.\n\t\treturn {\n\t\t\tscore: score,\n\t\t\tresultText: i18n.sprintf(\n\t\t\t\t/* Translators: %1$s and %5$s expand to a link on yoast.com,\n\t\t\t\t\t%2$s to the anchor end tag,\n\t\t\t\t\t%7$s expands to the anchor end tag and a full stop,\n\t\t\t\t\t%3$s expands to the numeric Flesch reading ease score,\n\t\t\t\t\t%4$s to the easiness of reading,\n\t\t\t\t\t%6$s expands to a call to action based on the score */\n\t\t\t\ti18n.dgettext(\n\t\t\t\t\t\"js-text-analysis\",\n\t\t\t\t\t\"%1$sFlesch Reading Ease%2$s: The copy scores %3$s in the test, which is considered %4$s to read. %5$s%6$s%7$s\"\n\t\t\t\t),\n\t\t\t\tthis._config.urlTitle,\n\t\t\t\t\"</a>\",\n\t\t\t\tthis.fleschReadingResult,\n\t\t\t\tfeedback,\n\t\t\t\tthis._config.urlCallToAction,\n\t\t\t\tnote,\n\t\t\t\t\"</a>.\",\n\t\t\t),\n\t\t};\n\t}\n\n\t/**\n\t * Checks if Flesch reading analysis is available for the language of the paper.\n\t *\n\t * @param {Object} paper The paper to have the Flesch score to be calculated for.\n\t * @returns {boolean} Returns true if the language is available and the paper is not empty.\n\t */\n\tisApplicable( paper ) {\n\t\tconst isLanguageAvailable = getLanguageAvailability( paper.getLocale(), availableLanguages );\n\t\treturn ( isLanguageAvailable && paper.hasText() );\n\t}\n}\n\nexport default FleschReadingEaseAssessment;\n"]}