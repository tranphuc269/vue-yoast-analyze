{"version":3,"sources":["../../src/snippetPreview.js"],"names":["snippetEditorTemplate","templates","snippetEditor","hiddenElement","hiddenSpan","defaults","data","title","metaDesc","urlPath","titleWidth","metaHeight","placeholder","defaultValue","baseURL","callbacks","saveSnippetData","addTrailingSlash","metaDescriptionDate","previewMode","titleMaxLength","maximumMetaDescriptionLength","Config","maxMeta","inputPreviewBindings","preview","inputField","getBaseURL","opts","hasApp","refObj","rawData","baseUrl","retrieveUnformattedText","key","updateUnformattedText","value","element","input","hasTrailingSlash","url","indexOf","length","hasProgressSupport","progressElement","document","createElement","max","rateTitleLength","titleLength","rating","rateMetaDescLength","metaDescLength","updateProgressBar","maximum","barElement","progress","allClasses","domManipulation","removeClasses","addClass","getElementsByClassName","style","width","SnippetPreview","analyzerApp","i18n","snippetTitle","snippetCite","snippetMeta","metaTitle","targetElement","Error","_currentFocus","_currentHover","unformattedText","Object","defineProperty","get","bind","set","prototype","renderTemplate","innerHTML","raw","meta","rendered","formatTitle","formatUrl","formatCite","formatMeta","edit","dgettext","slug","metaDescription","save","snippetPreview","titleLabel","slugLabel","metaDescriptionLabel","snippetPreviewDescription","desktopPreviewMode","mobilePreviewMode","isScrollableHint","measurers","getElementById","urlBase","container","formContainer","editToggle","closeEditor","formFields","label","parentNode","initPreviewToggler","setInitialView","opened","createMeasurementElements","updateProgressBars","snippetPreviewToggle","SnippetPreviewToggler","initialize","bindEvents","refresh","output","htmlOutput","renderOutput","renderSnippetStyle","measureTitle","measureMetaDescription","getAnalyzerTitle","hasPluggable","pluggable","_applyModifications","getAnalyzerMetaDesc","getAnalyzerData","call","callRegisteredEventBinder","bindElementEvents","init","cite","html","loaded","replace","keyword","formatKeywordUrl","getMetaText","substring","formatKeyword","metaText","excerpt","text","getIndexMatches","indexMatches","i","match","push","getPeriodMatches","periodMatches","textString","keywordRegex","str","transliterateKeyword","locale","dashedKeyword","metaDescElement","removeClass","reRender","checkTextLength","event","currentTarget","textContent","id","className","YoastSEO","app","snippet_meta","snippet_title","getUnformattedText","currentElement","setUnformattedText","elem","validateFields","metaDescriptionRating","titleRating","previewWidth","getBoundingClientRect","setVisibility","handleWindowResizing","setScrollHintVisibility","elems","addEventListener","changedInput","toggleEditor","window","binding","previewElement","inputElement","openEditor","focus","_updateFocusCarets","_updateHoverCarets","updateDataFromDOM","setAttribute","focusedLabel","focusedPreview","hoveredLabel","setTitle","setUrlPath","setMetaDescription","metaDescriptionElement","spanHolder","offsetWidth","whiteSpace","body","appendChild","childNodes","metaHeightElement","offsetHeight","getTitleWidth","setTitleWidth","disableEnter","ev","textFeedback","showEditIcon","hideEditIcon","setFocus"],"mappings":"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","file":"snippetPreview.js","sourcesContent":["import { isEmpty } from \"lodash-es\";\nimport { isElement } from \"lodash-es\";\nimport { isUndefined } from \"lodash-es\";\nimport { clone } from \"lodash-es\";\nimport { defaultsDeep } from \"lodash-es\";\nimport { forEach } from \"lodash-es\";\nimport { debounce } from \"lodash-es\";\n\nimport createWordRegex from \"./stringProcessing/createWordRegex.js\";\nimport { stripFullTags as stripHTMLTags } from \"./stringProcessing/stripHTMLTags.js\";\nimport stripSpaces from \"./stringProcessing/stripSpaces.js\";\nimport replaceDiacritics from \"./stringProcessing/replaceDiacritics.js\";\nimport transliterate from \"./stringProcessing/transliterate.js\";\nimport templates from \"./templates.js\";\nvar snippetEditorTemplate = templates.snippetEditor;\nvar hiddenElement = templates.hiddenSpan;\n\nimport SnippetPreviewToggler from \"./snippetPreviewToggler\";\nimport domManipulation from \"./helpers/domManipulation.js\";\n\nimport Config from \"./config/config\";\n\nvar defaults = {\n\tdata: {\n\t\ttitle: \"\",\n\t\tmetaDesc: \"\",\n\t\turlPath: \"\",\n\t\ttitleWidth: 0,\n\t\tmetaHeight: 0,\n\t},\n\tplaceholder: {\n\t\ttitle: \"This is an example title - edit by clicking here\",\n\t\tmetaDesc: \"Modify your meta description by editing it right here\",\n\t\turlPath: \"example-post/\",\n\t},\n\tdefaultValue: {\n\t\ttitle: \"\",\n\t\tmetaDesc: \"\",\n\t},\n\tbaseURL: \"http://example.com/\",\n\tcallbacks: {\n\t\t/**\n\t\t * Empty function.\n\t\t * @returns {void}\n\t\t */\n\t\tsaveSnippetData: function() {},\n\t},\n\taddTrailingSlash: true,\n\tmetaDescriptionDate: \"\",\n\tpreviewMode: \"desktop\",\n\n};\n\nvar titleMaxLength = 600;\nconst maximumMetaDescriptionLength = Config.maxMeta;\n\nvar inputPreviewBindings = [\n\t{\n\t\tpreview: \"title_container\",\n\t\tinputField: \"title\",\n\t},\n\t{\n\t\tpreview: \"url_container\",\n\t\tinputField: \"urlPath\",\n\t},\n\t{\n\t\tpreview: \"meta_container\",\n\t\tinputField: \"metaDesc\",\n\t},\n];\n\n/**\n * Get's the base URL for this instance of the Snippet Preview.\n *\n * @private\n * @this SnippetPreview\n *\n * @returns {string} The base URL.\n */\nvar getBaseURL = function() {\n\tvar baseURL = this.opts.baseURL;\n\n\t/*\n\t * For backwards compatibility, if no URL was passed to the snippet editor we try to retrieve the base URL from the\n\t * rawData in the App. This is because the scrapers used to be responsible for retrieving the baseURL, but the base\n\t * URL is static so we can just pass it to the snippet editor.\n\t */\n\tif ( this.hasApp() && ! isEmpty( this.refObj.rawData.baseUrl ) && this.opts.baseURL === defaults.baseURL ) {\n\t\tbaseURL = this.refObj.rawData.baseUrl;\n\t}\n\n\treturn baseURL;\n};\n\n/**\n * Retrieves unformatted text from the data object\n *\n * @private\n * @this SnippetPreview\n *\n * @param {string} key The key to retrieve.\n *\n * @returns {string} The unformatted text.\n */\nfunction retrieveUnformattedText( key ) {\n\treturn this.data[ key ];\n}\n\n/**\n * Update data and DOM objects when the unformatted text is updated, here for backwards compatibility\n *\n * @private\n * @this SnippetPreview\n *\n * @param {string} key The data key to update.\n * @param {string} value The value to update.\n *\n * @returns {void}\n */\nfunction updateUnformattedText( key, value ) {\n\tthis.element.input[ key ].value = value;\n\n\tthis.data[ key ] = value;\n}\n\n/**\n * Returns if a url has a trailing slash or not.\n *\n * @param {string} url The url to check for a trailing slash.\n *\n * @returns {boolean} Whether or not the url contains a trailing slash.\n */\nfunction hasTrailingSlash( url ) {\n\treturn url.indexOf( \"/\" ) === ( url.length - 1 );\n}\n\n/**\n * Detects if this browser has <progress> support. Also serves as a poor man's HTML5shiv.\n *\n * @private\n *\n * @returns {boolean} Whether or not the browser supports a <progress> element\n */\nfunction hasProgressSupport() {\n\tvar progressElement = document.createElement( \"progress\" );\n\n\treturn ! isUndefined( progressElement.max );\n}\n\n/**\n * Returns a rating based on the length of the title\n *\n * @param {number} titleLength the length of the title.\n *\n * @returns {string} The rating given based on the title length.\n */\nfunction rateTitleLength( titleLength ) {\n\tvar rating;\n\n\tswitch ( true ) {\n\t\tcase titleLength > 0 && titleLength <= 399:\n\t\tcase titleLength > 600:\n\t\t\trating = \"ok\";\n\t\t\tbreak;\n\n\t\tcase titleLength >= 400 && titleLength <= 600:\n\t\t\trating = \"good\";\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\trating = \"bad\";\n\t\t\tbreak;\n\t}\n\n\treturn rating;\n}\n\n/**\n * Returns a rating based on the length of the meta description\n *\n * @param {number} metaDescLength the length of the meta description.\n *\n * @returns {string} The rating given based on the description length.\n */\nfunction rateMetaDescLength( metaDescLength ) {\n\tvar rating;\n\n\tswitch ( true ) {\n\t\tcase metaDescLength > 0 && metaDescLength < 120:\n\t\tcase metaDescLength > maximumMetaDescriptionLength:\n\t\t\trating = \"ok\";\n\t\t\tbreak;\n\n\t\tcase metaDescLength >= 120 && metaDescLength <= maximumMetaDescriptionLength:\n\t\t\trating = \"good\";\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\trating = \"bad\";\n\t\t\tbreak;\n\t}\n\n\treturn rating;\n}\n\n/**\n * Updates a progress bar\n *\n * @private\n * @this SnippetPreview\n *\n * @param {HTMLElement} element The progress element that's rendered.\n * @param {number} value The current value.\n * @param {number} maximum The maximum allowed value.\n * @param {string} rating The SEO score rating for this value.\n *\n * @returns {void}\n */\nfunction updateProgressBar( element, value, maximum, rating ) {\n\tvar barElement, progress,\n\t\tallClasses = [\n\t\t\t\"snippet-editor__progress--bad\",\n\t\t\t\"snippet-editor__progress--ok\",\n\t\t\t\"snippet-editor__progress--good\",\n\t\t];\n\n\telement.value = value;\n\tdomManipulation.removeClasses( element, allClasses );\n\tdomManipulation.addClass( element, \"snippet-editor__progress--\" + rating );\n\n\tif ( ! this.hasProgressSupport ) {\n\t\tbarElement = element.getElementsByClassName( \"snippet-editor__progress-bar\" )[ 0 ];\n\t\tprogress = ( value / maximum ) * 100;\n\n\t\tbarElement.style.width = progress + \"%\";\n\t}\n}\n\n/**\n * @module snippetPreview\n */\n\n/**\n * Defines the config and outputTarget for the SnippetPreview\n *\n * @param {Object}         opts                           - Snippet preview options.\n * @param {App}            opts.analyzerApp               - The app object the Snippet Preview is part of.\n * @param {Object}         opts.placeholder               - The placeholder values for the fields, will be shown as\n * actual placeholders in the inputs and as a fallback for the preview.\n * @param {string}         opts.placeholder.title         - The placeholder title.\n * @param {string}         opts.placeholder.metaDesc      - The placeholder meta description.\n * @param {string}         opts.placeholder.urlPath       - The placeholder url.\n *\n * @param {Object}         opts.defaultValue              - The default value for the fields, if the user has not\n * changed a field, this value will be used for the analyzer, preview and the progress bars.\n * @param {string}         opts.defaultValue.title        - The default title.\n * @param {string}         opts.defaultValue.metaDesc     - The default meta description.\n * it.\n *\n * @param {string}         opts.baseURL                   - The basic URL as it will be displayed in google.\n * @param {HTMLElement}    opts.targetElement             - The target element that contains this snippet editor.\n *\n * @param {Object}         opts.callbacks                 - Functions that are called on specific instances.\n * @param {Function}       opts.callbacks.saveSnippetData - Function called when the snippet data is changed.\n *\n * @param {boolean}        opts.addTrailingSlash          - Whether or not to add a trailing slash to the URL.\n * @param {string}         opts.metaDescriptionDate       - The date to display before the meta description.\n *\n * @param {Jed}            opts.i18n                      - The translation object.\n *\n * @param {string}         opts.previewMode               - The current preview mode.\n *\n * @property {App}         refObj                         - The connected app object.\n * @property {Jed}         i18n                           - The translation object.\n *\n * @property {HTMLElement} targetElement                  - The target element that contains this snippet editor.\n *\n * @property {Object}      element                        - The elements for this snippet editor.\n * @property {Object}      element.rendered               - The rendered elements.\n * @property {HTMLElement} element.rendered.title         - The rendered title element.\n * @property {HTMLElement} element.rendered.urlPath       - The rendered url path element.\n * @property {HTMLElement} element.rendered.urlBase       - The rendered url base element.\n * @property {HTMLElement} element.rendered.metaDesc      - The rendered meta description element.\n *\n * @property {HTMLElement} element.measurers.titleWidth   - The rendered title width element.\n * @property {HTMLElement} element.measurers.metaHeight   - The rendered meta height element.\n *\n * @property {Object}      element.input                  - The input elements.\n * @property {HTMLElement} element.input.title            - The title input element.\n * @property {HTMLElement} element.input.urlPath          - The url path input element.\n * @property {HTMLElement} element.input.metaDesc         - The meta description input element.\n *\n * @property {HTMLElement} element.container              - The main container element.\n * @property {HTMLElement} element.formContainer          - The form container element.\n * @property {HTMLElement} element.editToggle             - The button that toggles the editor form.\n *\n * @property {Object}      data                           - The data for this snippet editor.\n * @property {string}      data.title                     - The title.\n * @property {string}      data.urlPath                   - The url path.\n * @property {string}      data.metaDesc                  - The meta description.\n * @property {int}         data.titleWidth                - The width of the title in pixels.\n * @property {int}         data.metaHeight                - The height of the meta description in pixels.\n *\n * @property {string}      baseURL                        - The basic URL as it will be displayed in google.\n *\n * @property {boolean}     hasProgressSupport             - Whether this browser supports the <progress> element.\n *\n * @constructor\n */\nvar SnippetPreview = function( opts ) {\n\tdefaultsDeep( opts, defaults );\n\n\tthis.data = opts.data;\n\n\tif ( ! isUndefined( opts.analyzerApp ) ) {\n\t\tthis.refObj = opts.analyzerApp;\n\t\tthis.i18n = this.refObj.i18n;\n\n\t\tthis.data = {\n\t\t\ttitle: this.refObj.rawData.snippetTitle || \"\",\n\t\t\turlPath: this.refObj.rawData.snippetCite || \"\",\n\t\t\tmetaDesc: this.refObj.rawData.snippetMeta || \"\",\n\t\t};\n\n\t\t// For backwards compatibility set the metaTitle as placeholder.\n\t\tif ( ! isEmpty( this.refObj.rawData.metaTitle ) ) {\n\t\t\topts.placeholder.title = this.refObj.rawData.metaTitle;\n\t\t}\n\t}\n\n\tif ( ! isUndefined( opts.i18n ) ) {\n\t\tthis.i18n = opts.i18n;\n\t}\n\n\tif ( ! isElement( opts.targetElement ) ) {\n\t\tthrow new Error( \"The snippet preview requires a valid target element\" );\n\t}\n\n\tthis.opts = opts;\n\tthis._currentFocus = null;\n\tthis._currentHover = null;\n\n\t// For backwards compatibility monitor the unformatted text for changes and reflect them in the preview\n\tthis.unformattedText = {};\n\tObject.defineProperty( this.unformattedText, \"snippet_cite\", {\n\t\tget: retrieveUnformattedText.bind( this, \"urlPath\" ),\n\t\tset: updateUnformattedText.bind( this, \"urlPath\" ),\n\t} );\n\tObject.defineProperty( this.unformattedText, \"snippet_meta\", {\n\t\tget: retrieveUnformattedText.bind( this, \"metaDesc\" ),\n\t\tset: updateUnformattedText.bind( this, \"metaDesc\" ),\n\t} );\n\tObject.defineProperty( this.unformattedText, \"snippet_title\", {\n\t\tget: retrieveUnformattedText.bind( this, \"title\" ),\n\t\tset: updateUnformattedText.bind( this, \"title\" ),\n\t} );\n};\n\n/**\n * Renders snippet editor and adds it to the targetElement\n * @returns {void}\n */\nSnippetPreview.prototype.renderTemplate = function() {\n\tvar targetElement = this.opts.targetElement;\n\n\ttargetElement.innerHTML = snippetEditorTemplate( {\n\t\traw: {\n\t\t\ttitle: this.data.title,\n\t\t\tsnippetCite: this.data.urlPath,\n\t\t\tmeta: this.data.metaDesc,\n\t\t},\n\t\trendered: {\n\t\t\ttitle: this.formatTitle(),\n\t\t\tbaseUrl: this.formatUrl(),\n\t\t\tsnippetCite: this.formatCite(),\n\t\t\tmeta: this.formatMeta(),\n\t\t},\n\t\tmetaDescriptionDate: this.opts.metaDescriptionDate,\n\t\tplaceholder: this.opts.placeholder,\n\t\ti18n: {\n\t\t\tedit: this.i18n.dgettext( \"js-text-analysis\", \"Edit snippet\" ),\n\t\t\ttitle: this.i18n.dgettext( \"js-text-analysis\", \"SEO title\" ),\n\t\t\tslug: this.i18n.dgettext( \"js-text-analysis\", \"Slug\" ),\n\t\t\tmetaDescription: this.i18n.dgettext( \"js-text-analysis\", \"Meta description\" ),\n\t\t\tsave: this.i18n.dgettext( \"js-text-analysis\", \"Close snippet editor\" ),\n\t\t\tsnippetPreview: this.i18n.dgettext( \"js-text-analysis\", \"Google preview\" ),\n\t\t\ttitleLabel: this.i18n.dgettext( \"js-text-analysis\", \"SEO title preview:\" ),\n\t\t\tslugLabel: this.i18n.dgettext( \"js-text-analysis\", \"Slug preview:\" ),\n\t\t\tmetaDescriptionLabel: this.i18n.dgettext( \"js-text-analysis\", \"Meta description preview:\" ),\n\t\t\tsnippetPreviewDescription: this.i18n.dgettext(\n\t\t\t\t\"js-text-analysis\",\n\t\t\t\t\"You can click on each element in the preview to jump to the Snippet Editor.\"\n\t\t\t),\n\t\t\tdesktopPreviewMode: this.i18n.dgettext( \"js-text-analysis\", \"Desktop preview\" ),\n\t\t\tmobilePreviewMode: this.i18n.dgettext( \"js-text-analysis\", \"Mobile preview\" ),\n\t\t\tisScrollableHint: this.i18n.dgettext( \"js-text-analysis\", \"Scroll to see the preview content.\" ),\n\t\t},\n\t} );\n\n\tthis.element = {\n\t\tmeasurers: {\n\t\t\tmetaHeight: null,\n\t\t},\n\t\trendered: {\n\t\t\ttitle: document.getElementById( \"snippet_title\" ),\n\t\t\turlBase: document.getElementById( \"snippet_citeBase\" ),\n\t\t\turlPath: document.getElementById( \"snippet_cite\" ),\n\t\t\tmetaDesc: document.getElementById( \"snippet_meta\" ),\n\t\t},\n\t\tinput: {\n\t\t\ttitle: targetElement.getElementsByClassName( \"js-snippet-editor-title\" )[ 0 ],\n\t\t\turlPath: targetElement.getElementsByClassName( \"js-snippet-editor-slug\" )[ 0 ],\n\t\t\tmetaDesc: targetElement.getElementsByClassName( \"js-snippet-editor-meta-description\" )[ 0 ],\n\t\t},\n\t\tprogress: {\n\t\t\ttitle: targetElement.getElementsByClassName( \"snippet-editor__progress-title\" )[ 0 ],\n\t\t\tmetaDesc: targetElement.getElementsByClassName( \"snippet-editor__progress-meta-description\" )[ 0 ],\n\t\t},\n\t\tcontainer: document.getElementById( \"snippet_preview\" ),\n\t\tformContainer: targetElement.getElementsByClassName( \"snippet-editor__form\" )[ 0 ],\n\t\teditToggle: targetElement.getElementsByClassName( \"snippet-editor__edit-button\" )[ 0 ],\n\t\tcloseEditor: targetElement.getElementsByClassName( \"snippet-editor__submit\" )[ 0 ],\n\t\tformFields: targetElement.getElementsByClassName( \"snippet-editor__form-field\" ),\n\t};\n\n\tthis.element.label = {\n\t\ttitle: this.element.input.title.parentNode,\n\t\turlPath: this.element.input.urlPath.parentNode,\n\t\tmetaDesc: this.element.input.metaDesc.parentNode,\n\t};\n\n\tthis.element.preview = {\n\t\ttitle: this.element.rendered.title.parentNode,\n\t\turlPath: this.element.rendered.urlPath.parentNode,\n\t\tmetaDesc: this.element.rendered.metaDesc.parentNode,\n\t};\n\n\tthis.hasProgressSupport = hasProgressSupport();\n\n\tif ( this.hasProgressSupport ) {\n\t\tthis.element.progress.title.max = titleMaxLength;\n\t\tthis.element.progress.metaDesc.max = maximumMetaDescriptionLength;\n\t} else {\n\t\tforEach( this.element.progress, function( progressElement ) {\n\t\t\tdomManipulation.addClass( progressElement, \"snippet-editor__progress--fallback\" );\n\t\t} );\n\t}\n\n\tthis.initPreviewToggler();\n\tthis.setInitialView();\n\n\tthis.opened = false;\n\tthis.createMeasurementElements();\n\tthis.updateProgressBars();\n};\n\n/**\n * Initializes the Snippet Preview Toggler.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.initPreviewToggler = function() {\n\tthis.snippetPreviewToggle = new SnippetPreviewToggler(\n\t\tthis.opts.previewMode, this.opts.targetElement.getElementsByClassName( \"snippet-editor__view-icon\" )\n\t);\n\tthis.snippetPreviewToggle.initialize();\n\tthis.snippetPreviewToggle.bindEvents();\n};\n\n/**\n * Refreshes the snippet editor rendered HTML\n * @returns {void}\n */\nSnippetPreview.prototype.refresh = function() {\n\tthis.output = this.htmlOutput();\n\tthis.renderOutput();\n\tthis.renderSnippetStyle();\n\tthis.measureTitle();\n\tthis.measureMetaDescription();\n\tthis.updateProgressBars();\n};\n\n/**\n * Returns the title as meant for the analyzer\n *\n * @private\n * @this SnippetPreview\n *\n * @returns {string} The title that is meant for the analyzer.\n */\nfunction getAnalyzerTitle() {\n\tvar title = this.data.title;\n\n\tif ( isEmpty( title ) ) {\n\t\ttitle = this.opts.defaultValue.title;\n\t}\n\n\tif ( this.hasPluggable() ) {\n\t\ttitle = this.refObj.pluggable._applyModifications( \"data_page_title\", title );\n\t}\n\n\treturn stripSpaces( title );\n}\n\n/**\n * Returns the metaDescription, includes the date if it is set.\n *\n * @private\n * @this SnippetPreview\n *\n * @returns {string} The meta data for the analyzer.\n */\nvar getAnalyzerMetaDesc = function() {\n\tvar metaDesc = this.data.metaDesc;\n\n\tif ( isEmpty( metaDesc ) ) {\n\t\tmetaDesc = this.opts.defaultValue.metaDesc;\n\t}\n\n\tif ( this.hasPluggable() ) {\n\t\tmetaDesc = this.refObj.pluggable._applyModifications( \"data_meta_desc\", metaDesc );\n\t}\n\n\tif ( ! isEmpty( this.opts.metaDescriptionDate ) && ! isEmpty( metaDesc ) ) {\n\t\tmetaDesc = this.opts.metaDescriptionDate + \" - \" + this.data.metaDesc;\n\t}\n\n\treturn stripSpaces( metaDesc );\n};\n\n/**\n * Returns the data from the Snippet Preview.\n *\n * @returns {Object} The collected data for the analyzer.\n */\nSnippetPreview.prototype.getAnalyzerData = function() {\n\treturn {\n\t\ttitle: getAnalyzerTitle.call( this ),\n\t\turl: this.data.urlPath,\n\t\tmetaDesc: getAnalyzerMetaDesc.call( this ),\n\t};\n};\n\n/**\n * Calls the event binder that has been registered using the callbacks option in the arguments of the App.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.callRegisteredEventBinder = function() {\n\tif ( this.hasApp() ) {\n\t\tthis.refObj.callbacks.bindElementEvents( this.refObj );\n\t}\n};\n\n/**\n *  Checks if title and url are set so they can be rendered in the Snippet Preview.\n *\n *  @returns {void}\n */\nSnippetPreview.prototype.init = function() {\n\tif (\n\t\tthis.hasApp() &&\n\t\tthis.refObj.rawData.metaTitle !== null &&\n\t\tthis.refObj.rawData.cite !== null\n\t) {\n\t\tthis.refresh();\n\t}\n};\n\n/**\n * Creates html object to contain the strings for the Snippet Preview.\n *\n * @returns {Object} The HTML output of the collected data.\n */\nSnippetPreview.prototype.htmlOutput = function() {\n\tvar html = {};\n\thtml.title = this.formatTitle();\n\thtml.cite = this.formatCite();\n\thtml.meta = this.formatMeta();\n\thtml.url = this.formatUrl();\n\treturn html;\n};\n\n/**\n * Formats the title for the Snippet Preview. If title and pageTitle are empty, sampletext is used.\n *\n * @returns {string} The correctly formatted title.\n */\nSnippetPreview.prototype.formatTitle = function() {\n\tvar title = this.data.title;\n\n\t// Fallback to the default if the title is empty.\n\tif ( isEmpty( title ) ) {\n\t\ttitle = this.opts.defaultValue.title;\n\t}\n\n\t// For rendering we can fallback to the placeholder as well.\n\tif ( isEmpty( title ) ) {\n\t\ttitle = this.opts.placeholder.title;\n\t}\n\n\t// Apply modification to the title before showing it.\n\tif ( this.hasPluggable() && this.refObj.pluggable.loaded ) {\n\t\ttitle = this.refObj.pluggable._applyModifications( \"data_page_title\", title );\n\t}\n\n\ttitle = stripHTMLTags( title );\n\n\t// As an ultimate fallback provide the user with a helpful message.\n\tif ( isEmpty( title ) ) {\n\t\ttitle = this.i18n.dgettext( \"js-text-analysis\", \"Please provide an SEO title by editing the snippet below.\" );\n\t}\n\n\treturn title;\n};\n\n/**\n * Formats the base url for the Snippet Preview. Removes the protocol name from the URL.\n *\n * @returns {string} Formatted base url for the Snippet Preview.\n */\nSnippetPreview.prototype.formatUrl = function() {\n\tvar url = getBaseURL.call( this );\n\n\t// Removes the http part of the url, google displays https:// if the website supports it.\n\treturn url.replace( /http:\\/\\//ig, \"\" );\n};\n\n/**\n * Formats the url for the Snippet Preview.\n *\n * @returns {string} Formatted URL for the Snippet Preview.\n */\nSnippetPreview.prototype.formatCite = function() {\n\tvar cite = this.data.urlPath;\n\n\tcite = replaceDiacritics( stripHTMLTags( cite ) );\n\n\t// Fallback to the default if the cite is empty.\n\tif ( isEmpty( cite ) ) {\n\t\tcite = this.opts.placeholder.urlPath;\n\t}\n\n\tif ( this.hasApp() && ! isEmpty( this.refObj.rawData.keyword ) ) {\n\t\tcite = this.formatKeywordUrl( cite );\n\t}\n\n\tif ( this.opts.addTrailingSlash && ! hasTrailingSlash( cite ) ) {\n\t\tcite = cite + \"/\";\n\t}\n\n\t// URL's cannot contain whitespace so replace it by dashes.\n\tcite = cite.replace( /\\s/g, \"-\" );\n\t// Strip out question mark and hash characters from the raw URL.\n\tcite = cite.replace( /\\?|#/g, \"\" );\n\n\treturn cite;\n};\n\n/**\n * Formats the meta description for the Snippet Preview, if it's empty retrieves it using getMetaText.\n *\n * @returns {string} Formatted meta description.\n */\nSnippetPreview.prototype.formatMeta = function() {\n\tvar meta = this.data.metaDesc;\n\n\t// If no meta has been set, generate one.\n\tif ( isEmpty( meta ) ) {\n\t\tmeta = this.getMetaText();\n\t}\n\n\t// Apply modification to the desc before showing it.\n\tif ( this.hasPluggable() && this.refObj.pluggable.loaded ) {\n\t\tmeta = this.refObj.pluggable._applyModifications( \"data_meta_desc\", meta );\n\t}\n\n\tmeta = stripHTMLTags( meta );\n\n\t// Cut-off the meta description according to the maximum length\n\tmeta = meta.substring( 0, maximumMetaDescriptionLength );\n\n\tif ( this.hasApp() && ! isEmpty( this.refObj.rawData.keyword ) ) {\n\t\tmeta = this.formatKeyword( meta );\n\t}\n\n\t// As an ultimate fallback provide the user with a helpful message.\n\tif ( isEmpty( meta ) ) {\n\t\tmeta = this.i18n.dgettext( \"js-text-analysis\", \"Please provide a meta description by editing the snippet below.\" );\n\t}\n\n\treturn meta;\n};\n\n/**\n * Generates a meta description with an educated guess based on the passed text and excerpt.\n * It uses the keyword to select an appropriate part of the text. If the keyword isn't present it takes the maximum\n * meta description length of the text. If both the keyword, text and excerpt are empty this function returns the\n * sample text.\n *\n * @returns {string} A generated meta description.\n */\nSnippetPreview.prototype.getMetaText = function() {\n\tvar metaText = this.opts.defaultValue.metaDesc;\n\n\tif ( this.hasApp() && ! isUndefined( this.refObj.rawData.excerpt ) && isEmpty( metaText ) ) {\n\t\tmetaText = this.refObj.rawData.excerpt;\n\t}\n\n\tif ( this.hasApp() && ! isUndefined( this.refObj.rawData.text ) && isEmpty( metaText ) ) {\n\t\tmetaText = this.refObj.rawData.text;\n\n\t\tif ( this.hasPluggable() && this.refObj.pluggable.loaded ) {\n\t\t\tmetaText = this.refObj.pluggable._applyModifications( \"content\", metaText );\n\t\t}\n\t}\n\n\tmetaText = stripHTMLTags( metaText );\n\n\treturn metaText.substring( 0, maximumMetaDescriptionLength );\n};\n\n/**\n * Builds an array with all indexes of the keyword.\n *\n * @returns {Array} Array with matches\n */\nSnippetPreview.prototype.getIndexMatches = function() {\n\tvar indexMatches = [];\n\tvar i = 0;\n\n\t// Starts at 0, locates first match of the keyword.\n\tvar match = this.refObj.rawData.text.indexOf(\n\t\tthis.refObj.rawData.keyword,\n\t\ti\n\t);\n\n\t// Runs the loop untill no more indexes are found, and match returns -1.\n\twhile ( match > -1 ) {\n\t\tindexMatches.push( match );\n\n\t\t// Pushes location to indexMatches and increase i with the length of keyword.\n\t\ti = match + this.refObj.rawData.keyword.length;\n\t\tmatch = this.refObj.rawData.text.indexOf(\n\t\t\tthis.refObj.rawData.keyword,\n\t\t\ti\n\t\t);\n\t}\n\treturn indexMatches;\n};\n\n/**\n * Builds an array with indexes of all sentence ends (select on .).\n *\n * @returns {Array} Array with sentences.\n */\nSnippetPreview.prototype.getPeriodMatches = function() {\n\tvar periodMatches = [ 0 ];\n\tvar match;\n\tvar i = 0;\n\twhile ( ( match = this.refObj.rawData.text.indexOf( \".\", i ) ) > -1 ) {\n\t\tperiodMatches.push( match );\n\t\ti = match + 1;\n\t}\n\treturn periodMatches;\n};\n\n/**\n * Formats the keyword for use in the snippetPreview by adding <strong>-tags\n * strips unwanted characters that could break the regex or give unwanted results.\n *\n * @param {string} textString The keyword string that needs to be formatted.\n *\n * @returns {string} The formatted keyword.\n */\nSnippetPreview.prototype.formatKeyword = function( textString ) {\n\t// Removes characters from the keyword that could break the regex, or give unwanted results.\n\tvar keyword = this.refObj.rawData.keyword;\n\n\t// Match keyword case-insensitively.\n\tvar keywordRegex = createWordRegex( keyword, \"\", false );\n\n\ttextString = textString.replace( keywordRegex, function( str ) {\n\t\treturn \"<strong>\" + str + \"</strong>\";\n\t} );\n\n\t// Transliterate the keyword for highlighting\n\tvar transliterateKeyword = transliterate( keyword, this.refObj.rawData.locale );\n\tif ( transliterateKeyword !== keyword ) {\n\t\tkeywordRegex = createWordRegex( transliterateKeyword, \"\", false );\n\t\ttextString = textString.replace( keywordRegex, function( str ) {\n\t\t\treturn \"<strong>\" + str + \"</strong>\";\n\t\t} );\n\t}\n\treturn textString;\n};\n\n/**\n * Formats the keyword for use in the URL by accepting - and _ instead of spaces and by adding <strong>-tags.\n * Strips unwanted characters that could break the regex or give unwanted results.\n *\n * @param {string} textString The keyword string that needs to be formatted.\n *\n * @returns {XML|string|void} The formatted keyword string to be used in the URL.\n */\nSnippetPreview.prototype.formatKeywordUrl = function( textString ) {\n\tvar keyword = this.refObj.rawData.keyword;\n\tkeyword = transliterate( keyword, this.refObj.rawData.locale );\n\tkeyword = keyword.replace( /'/, \"\" );\n\n\tvar dashedKeyword = keyword.replace( /\\s/g, \"-\" );\n\n\t// Match keyword case-insensitively.\n\tvar keywordRegex = createWordRegex( dashedKeyword, \"\\\\-\" );\n\n\t// Make the keyword bold in the textString.\n\treturn textString.replace( keywordRegex, function( str ) {\n\t\treturn \"<strong>\" + str + \"</strong>\";\n\t} );\n};\n\n/**\n * Renders the outputs to the elements on the page.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.renderOutput = function() {\n\tthis.element.rendered.title.innerHTML = this.output.title;\n\tthis.element.rendered.urlPath.innerHTML = this.output.cite;\n\tthis.element.rendered.urlBase.innerHTML = this.output.url;\n\tthis.element.rendered.metaDesc.innerHTML = this.output.meta;\n};\n\n/**\n * Makes the rendered meta description gray if no meta description has been set by the user.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.renderSnippetStyle = function() {\n\tvar metaDescElement = this.element.rendered.metaDesc;\n\tvar metaDesc = getAnalyzerMetaDesc.call( this );\n\n\tif ( isEmpty( metaDesc ) ) {\n\t\tdomManipulation.addClass( metaDescElement, \"desc-render\" );\n\t\tdomManipulation.removeClass( metaDescElement, \"desc-default\" );\n\t} else {\n\t\tdomManipulation.addClass( metaDescElement, \"desc-default\" );\n\t\tdomManipulation.removeClass( metaDescElement, \"desc-render\" );\n\t}\n};\n\n/**\n * Function to call init, to rerender the Snippet Preview.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.reRender = function() {\n\tthis.init();\n};\n\n/**\n * Checks text length of the snippetmeta and snippet title, shortens it if it is too long.\n * @param {Object} event The event to check the text length from.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.checkTextLength = function( event ) {\n\tvar text = event.currentTarget.textContent;\n\tswitch ( event.currentTarget.id ) {\n\t\tcase \"snippet_meta\":\n\t\t\tevent.currentTarget.className = \"desc\";\n\t\t\tif ( text.length > maximumMetaDescriptionLength ) {\n\t\t\t\t/* eslint-disable */\n\t\t\t\tYoastSEO.app.snippetPreview.unformattedText.snippet_meta = event.currentTarget.textContent;\n\t\t\t\t/* eslint-enable */\n\t\t\t\tevent.currentTarget.textContent = text.substring(\n\t\t\t\t\t0,\n\t\t\t\t\tmaximumMetaDescriptionLength\n\t\t\t\t);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase \"snippet_title\":\n\t\t\tevent.currentTarget.className = \"title\";\n\t\t\tif ( text.length > titleMaxLength ) {\n\t\t\t\t/* eslint-disable */\n\t\t\t\tYoastSEO.app.snippetPreview.unformattedText.snippet_title = event.currentTarget.textContent;\n\t\t\t\t/* eslint-enable */\n\t\t\t\tevent.currentTarget.textContent = text.substring( 0, titleMaxLength );\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n};\n\n/**\n * Get the unformatted text.\n *\n * When clicking on an element in the Snippet Preview, this checks and fills the textContent with the data from the\n * unformatted text. This removes the keyword highlighting and modified data so the original content can be editted.\n *\n * @param {Object} event The event to get the unformatted text from.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.getUnformattedText = function( event ) {\n\tvar currentElement = event.currentTarget.id;\n\tif ( typeof this.unformattedText[ currentElement ] !== \"undefined\" ) {\n\t\tevent.currentTarget.textContent = this.unformattedText[ currentElement ];\n\t}\n};\n\n/**\n * Sets the unformatted text.\n *\n * When text is entered into the snippetPreview elements, the text is set in the unformattedText object.\n * This allows the visible data to be editted in the snippetPreview.\n *\n * @param {Object} event The event to set the unformatted text from.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.setUnformattedText = function( event ) {\n\tvar elem =  event.currentTarget.id;\n\tthis.unformattedText[ elem ] = document.getElementById( elem ).textContent;\n};\n\n/**\n * Validates all fields and highlights errors.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.validateFields = function() {\n\tvar metaDescription = getAnalyzerMetaDesc.call( this );\n\tvar title = getAnalyzerTitle.call( this );\n\n\tif ( metaDescription.length > maximumMetaDescriptionLength ) {\n\t\tdomManipulation.addClass( this.element.input.metaDesc, \"snippet-editor__field--invalid\" );\n\t} else {\n\t\tdomManipulation.removeClass( this.element.input.metaDesc, \"snippet-editor__field--invalid\" );\n\t}\n\n\tif ( title.length > titleMaxLength ) {\n\t\tdomManipulation.addClass( this.element.input.title, \"snippet-editor__field--invalid\" );\n\t} else {\n\t\tdomManipulation.removeClass( this.element.input.title, \"snippet-editor__field--invalid\" );\n\t}\n};\n\n/**\n * Updates progress bars based on the available data.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.updateProgressBars = function() {\n\tvar metaDescriptionRating, titleRating, metaDescription;\n\n\tmetaDescription = getAnalyzerMetaDesc.call( this );\n\n\ttitleRating = rateTitleLength( this.data.titleWidth );\n\tmetaDescriptionRating = rateMetaDescLength( metaDescription.length );\n\n\tupdateProgressBar.call(\n\t\tthis,\n\t\tthis.element.progress.title,\n\t\tthis.data.titleWidth,\n\t\ttitleMaxLength,\n\t\ttitleRating\n\t);\n\n\tupdateProgressBar.call(\n\t\tthis,\n\t\tthis.element.progress.metaDesc,\n\t\tmetaDescription.length,\n\t\tmaximumMetaDescriptionLength,\n\t\tmetaDescriptionRating\n\t);\n};\n\n/**\n * Gets the width of the Snippet Preview to set its initial view to desktop or mobile.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.setInitialView = function() {\n\tvar previewWidth = document.getElementById( \"snippet_preview\" ).getBoundingClientRect().width;\n\tthis.snippetPreviewToggle.setVisibility( previewWidth );\n};\n\n/**\n * When the window is resized, gets the width of the Snippet Preview to set the Scroll Hint visibility.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.handleWindowResizing = debounce( function() {\n\tvar previewWidth = document.getElementById( \"snippet_preview\" ).getBoundingClientRect().width;\n\tthis.snippetPreviewToggle.setScrollHintVisibility( previewWidth );\n}, 25 );\n\n/**\n * Binds the reloadSnippetText function to the blur of the snippet inputs.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.bindEvents = function() {\n\tvar targetElement,\n\t\telems = [ \"title\", \"slug\", \"meta-description\" ];\n\n\tforEach( elems, function( elem ) {\n\t\ttargetElement = document.getElementsByClassName( \"js-snippet-editor-\" + elem )[ 0 ];\n\n\t\ttargetElement.addEventListener( \"keydown\", this.changedInput.bind( this ) );\n\t\ttargetElement.addEventListener( \"keyup\", this.changedInput.bind( this ) );\n\n\t\ttargetElement.addEventListener( \"input\", this.changedInput.bind( this ) );\n\t\ttargetElement.addEventListener( \"focus\", this.changedInput.bind( this ) );\n\t\ttargetElement.addEventListener( \"blur\", this.changedInput.bind( this ) );\n\t}.bind( this ) );\n\n\tthis.element.editToggle.addEventListener( \"click\", this.toggleEditor.bind( this ) );\n\tthis.element.closeEditor.addEventListener( \"click\", this.closeEditor.bind( this ) );\n\n\t// Note: `handleWindowResizing` is called also in Yoast SEO when the WP admin menu state changes.\n\twindow.addEventListener( \"resize\", this.handleWindowResizing.bind( this ) );\n\n\t// Loop through the bindings and bind a click handler to the click to focus the focus element.\n\tforEach( inputPreviewBindings, function( binding ) {\n\t\tvar previewElement = document.getElementById( binding.preview );\n\t\tvar inputElement = this.element.input[ binding.inputField ];\n\n\t\t// Make the preview element click open the editor and focus the correct input.\n\t\tpreviewElement.addEventListener( \"click\", function() {\n\t\t\tthis.openEditor();\n\t\t\tinputElement.focus();\n\t\t}.bind( this ) );\n\n\t\t// Make focusing an input, update the carets.\n\t\tinputElement.addEventListener( \"focus\", function() {\n\t\t\tthis._currentFocus = binding.inputField;\n\n\t\t\tthis._updateFocusCarets();\n\t\t}.bind( this ) );\n\n\t\t// Make removing focus from an element, update the carets.\n\t\tinputElement.addEventListener( \"blur\", function() {\n\t\t\tthis._currentFocus = null;\n\n\t\t\tthis._updateFocusCarets();\n\t\t}.bind( this ) );\n\n\t\tpreviewElement.addEventListener( \"mouseover\", function() {\n\t\t\tthis._currentHover = binding.inputField;\n\n\t\t\tthis._updateHoverCarets();\n\t\t}.bind( this ) );\n\n\t\tpreviewElement.addEventListener( \"mouseout\", function() {\n\t\t\tthis._currentHover = null;\n\n\t\t\tthis._updateHoverCarets();\n\t\t}.bind( this ) );\n\t}.bind( this ) );\n};\n\n/**\n * Updates Snippet Preview on changed input. It's debounced so that we can call this function as much as we want.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.changedInput = debounce( function() {\n\tthis.updateDataFromDOM();\n\tthis.validateFields();\n\tthis.updateProgressBars();\n\n\tthis.refresh();\n\n\tif ( this.hasApp() ) {\n\t\tthis.refObj.refresh();\n\t}\n}, 25 );\n\n/**\n * Updates our data object from the DOM.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.updateDataFromDOM = function() {\n\tthis.data.title = this.element.input.title.value;\n\tthis.data.urlPath = this.element.input.urlPath.value;\n\tthis.data.metaDesc = this.element.input.metaDesc.value;\n\n\t// Clone so the data isn't changeable.\n\tthis.opts.callbacks.saveSnippetData( clone( this.data ) );\n};\n\n/**\n * Opens the snippet editor.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.openEditor = function() {\n\tthis.element.editToggle.setAttribute( \"aria-expanded\", \"true\" );\n\n\t// Show these elements.\n\tdomManipulation.removeClass( this.element.formContainer, \"snippet-editor--hidden\" );\n\n\tthis.opened = true;\n};\n\n/**\n * Closes the snippet editor.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.closeEditor = function() {\n\t// Hide these elements.\n\tdomManipulation.addClass( this.element.formContainer, \"snippet-editor--hidden\" );\n\n\tthis.element.editToggle.setAttribute( \"aria-expanded\", \"false\" );\n\tthis.element.editToggle.focus();\n\n\tthis.opened = false;\n};\n\n/**\n * Toggles the snippet editor.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.toggleEditor = function() {\n\tif ( this.opened ) {\n\t\tthis.closeEditor();\n\t} else {\n\t\tthis.openEditor();\n\t}\n};\n\n/**\n * Updates carets before the preview and input fields.\n *\n * @private\n *\n * @returns {void}\n */\nSnippetPreview.prototype._updateFocusCarets = function() {\n\tvar focusedLabel, focusedPreview;\n\n\t// Disable all carets on the labels.\n\tforEach( this.element.label, function( element ) {\n\t\tdomManipulation.removeClass( element, \"snippet-editor__label--focus\" );\n\t} );\n\n\t// Disable all carets on the previews.\n\tforEach( this.element.preview, function( element ) {\n\t\tdomManipulation.removeClass( element, \"snippet-editor__container--focus\" );\n\t} );\n\n\tif ( null !== this._currentFocus ) {\n\t\tfocusedLabel = this.element.label[ this._currentFocus ];\n\t\tfocusedPreview = this.element.preview[ this._currentFocus ];\n\n\t\tdomManipulation.addClass( focusedLabel, \"snippet-editor__label--focus\" );\n\t\tdomManipulation.addClass( focusedPreview, \"snippet-editor__container--focus\" );\n\t}\n};\n\n/**\n * Updates hover carets before the input fields.\n *\n * @private\n *\n * @returns {void}\n */\nSnippetPreview.prototype._updateHoverCarets = function() {\n\tvar hoveredLabel;\n\n\tforEach( this.element.label, function( element ) {\n\t\tdomManipulation.removeClass( element, \"snippet-editor__label--hover\" );\n\t} );\n\n\tif ( null !== this._currentHover ) {\n\t\thoveredLabel = this.element.label[ this._currentHover ];\n\n\t\tdomManipulation.addClass( hoveredLabel, \"snippet-editor__label--hover\" );\n\t}\n};\n\n/**\n * Updates the title data and the title input field. This also means the snippet editor view is updated.\n *\n * @param {string} title The title to use in the input field.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.setTitle = function( title ) {\n\tthis.element.input.title.value = title;\n\n\tthis.changedInput();\n};\n\n/**\n * Updates the url path data and the url path input field. This also means the snippet editor view is updated.\n *\n * @param {string} urlPath the URL path to use in the input field.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.setUrlPath = function( urlPath ) {\n\tthis.element.input.urlPath.value = urlPath;\n\n\tthis.changedInput();\n};\n\n/**\n * Updates the meta description data and the meta description input field. This also means the snippet editor view is updated.\n *\n * @param {string} metaDesc the meta description to use in the input field.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.setMetaDescription = function( metaDesc ) {\n\tthis.element.input.metaDesc.value = metaDesc;\n\n\tthis.changedInput();\n};\n\n/**\n * Creates elements with the purpose to calculate the sizes of elements and puts these elements to the body.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.createMeasurementElements = function() {\n\tvar metaDescriptionElement, spanHolder;\n\tmetaDescriptionElement = hiddenElement(\n\t\t{\n\t\t\twidth: document.getElementById( \"meta_container\" ).offsetWidth + \"px\",\n\t\t\twhiteSpace: \"\",\n\t\t}\n\t);\n\n\tspanHolder = document.createElement( \"div\" );\n\tspanHolder.className = \"yoast-measurement-elements-holder\";\n\n\tspanHolder.innerHTML = metaDescriptionElement;\n\n\tdocument.body.appendChild( spanHolder );\n\n\tthis.element.measurers.metaHeight = spanHolder.childNodes[ 0 ];\n};\n\n/**\n * Copies the title text to the title measure element to calculate the width in pixels.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.measureTitle = function() {\n\tif ( this.element.rendered.title.offsetWidth !== 0 || this.element.rendered.title.textContent === \"\" ) {\n\t\tthis.data.titleWidth = this.element.rendered.title.offsetWidth;\n\t}\n};\n\n/**\n * Copies the metadescription text to the metadescription measure element to calculate the height in pixels.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.measureMetaDescription = function() {\n\tvar metaHeightElement = this.element.measurers.metaHeight;\n\n\tmetaHeightElement.innerHTML = this.element.rendered.metaDesc.innerHTML;\n\n\tthis.data.metaHeight = metaHeightElement.offsetHeight;\n};\n\n/**\n * Returns the width of the title in pixels.\n *\n * @returns {Number} The width of the title in pixels.\n */\nSnippetPreview.prototype.getTitleWidth = function() {\n\treturn this.data.titleWidth;\n};\n\n/**\n * Allows to manually set the title width.\n *\n * This may be useful in setups where the title field will not always be rendered.\n *\n * @param {Number} titleWidth The width of the title in pixels.\n *\n * @returns {void}\n */\nSnippetPreview.prototype.setTitleWidth = function( titleWidth ) {\n\tthis.data.titleWidth = titleWidth;\n};\n\n/**\n * Returns whether or not an app object is present.\n *\n * @returns {boolean} Whether or not there is an App object present.\n */\nSnippetPreview.prototype.hasApp = function() {\n\treturn ! isUndefined( this.refObj );\n};\n\n/**\n * Returns whether or not a pluggable object is present.\n *\n * @returns {boolean} Whether or not there is a Pluggable object present.\n */\nSnippetPreview.prototype.hasPluggable = function() {\n\treturn ! isUndefined( this.refObj ) && ! isUndefined( this.refObj.pluggable );\n};\n\n/* eslint-disable */\n\n/**\n * Disables Enter as input.\n *\n * Used to disable enter as input. Returns false to prevent enter, and preventDefault and\n * cancelBubble to prevent other elements from capturing this event.\n *\n * @deprecated\n *\n * @param {KeyboardEvent} ev The keyboard event.\n */\nSnippetPreview.prototype.disableEnter = function( ev ) {};\n\n/**\n * Adds and removes the tooLong class when a text is too long.\n *\n * @deprecated\n * @param ev The event.\n */\nSnippetPreview.prototype.textFeedback = function( ev ) {};\n\n/**\n * Shows the edit icon corresponding to the hovered element.\n *\n * @deprecated\n *\n * @param ev The event.\n */\nSnippetPreview.prototype.showEditIcon = function( ev ) {\n\n};\n\n/**\n * Removes all editIcon-classes, sets to snippet_container.\n *\n * @deprecated\n */\nSnippetPreview.prototype.hideEditIcon = function() {};\n\n/**\n * Sets focus on child element of the snippet_container that is clicked. Hides the editicon.\n *\n * @deprecated\n *\n * @param ev The event.\n */\nSnippetPreview.prototype.setFocus = function( ev ) {};\n\n/* eslint-disable */\nexport default SnippetPreview;\n"]}