{"version":3,"sources":["../../../src/researches/imageAltTags.js"],"names":["paper","researcher","topicForms","getResearch","matchAltProperties","getText","getLocale","imageMatches","locale","altProperties","noAlt","withAlt","withAltKeyword","withAltNonKeyword","i","length","alttag","keyphraseForms","keywordMatchedInAltTag","percentWordMatches"],"mappings":";;;;;;kBA6De,UAAUA,KAAV,EAAiBC,UAAjB,EAA8B;AAC5C,OAAMC,aAAaD,WAAWE,WAAX,CAAwB,YAAxB,CAAnB;;AAEA,QAAOC,mBAAoB,2BAAaJ,MAAMK,OAAN,EAAb,CAApB,EAAoDH,UAApD,EAAgEF,MAAMM,SAAN,EAAhE,CAAP;AACA,C;;AA/DD;;;;AACA;;;;AACA;;AAEA;;;;AAEA;;;;;;;;;AARA;;AAiBA,MAAMF,qBAAqB,SAArBA,kBAAqB,CAAUG,YAAV,EAAwBL,UAAxB,EAAoCM,MAApC,EAA6C;AACvE,OAAMC,gBAAgB;AACrBC,SAAO,CADc;AAErBC,WAAS,CAFY;AAGrBC,kBAAgB,CAHK;AAIrBC,qBAAmB;AAJE,EAAtB;;AAOA,MAAM,IAAIC,IAAI,CAAd,EAAiBA,IAAIP,aAAaQ,MAAlC,EAA0CD,GAA1C,EAAgD;AAC/C,QAAME,SAAS,gCAAaT,aAAcO,CAAd,CAAb,CAAf;;AAEA;AACA,MAAKE,WAAW,EAAhB,EAAqB;AACpBP,iBAAcC,KAAd;AACA;AACA;;AAED;AACA,MAAK,uBAASR,WAAWe,cAApB,CAAL,EAA4C;AAC3CR,iBAAcE,OAAd;AACA;AACA;;AAED;AACA,QAAMO,yBAAyB,sDAAwBhB,UAAxB,EAAoCc,MAApC,EAA4C,IAA5C,EAAkDR,MAAlD,CAA/B;AACA,MAAKU,uBAAuBC,kBAAvB,IAA6C,EAAlD,EAAuD;AACtDV,iBAAcG,cAAd;AACA;AACA;;AAEDH,gBAAcI,iBAAd;AACA;;AAED,QAAOJ,aAAP;AACA,CAlCD;;AAoCA","file":"imageAltTags.js","sourcesContent":["/** @module researches/imageAltTags */\n\nimport imageInText from \"../stringProcessing/imageInText\";\nimport imageAlttag from \"../stringProcessing/getAlttagContent\";\nimport { findTopicFormsInString } from \"../researches/findKeywordFormsInString\";\n\nimport { isEmpty } from \"lodash-es\";\n\n/**\n * Matches the alt-tags in the images found in the text.\n * Returns an object with the totals and different alt-tags.\n *\n * @param {Array} imageMatches Array with all the matched images in the text\n * @param {Object} topicForms The object with the keyphrase and the synonyms forms from the paper.\n * @param {string} locale The locale used for transliteration.\n * @returns {object} altProperties Object with all alt-tags that were found.\n */\nconst matchAltProperties = function( imageMatches, topicForms, locale ) {\n\tconst altProperties = {\n\t\tnoAlt: 0,\n\t\twithAlt: 0,\n\t\twithAltKeyword: 0,\n\t\twithAltNonKeyword: 0,\n\t};\n\n\tfor ( let i = 0; i < imageMatches.length; i++ ) {\n\t\tconst alttag = imageAlttag( imageMatches[ i ] );\n\n\t\t// If no alt-tag is set\n\t\tif ( alttag === \"\" ) {\n\t\t\taltProperties.noAlt++;\n\t\t\tcontinue;\n\t\t}\n\n\t\t// If no keyword is set, but the alt-tag is\n\t\tif ( isEmpty( topicForms.keyphraseForms ) ) {\n\t\t\taltProperties.withAlt++;\n\t\t\tcontinue;\n\t\t}\n\n\t\t// If the keyword is matched in the alt tag\n\t\tconst keywordMatchedInAltTag = findTopicFormsInString( topicForms, alttag, true, locale );\n\t\tif ( keywordMatchedInAltTag.percentWordMatches >= 50 ) {\n\t\t\taltProperties.withAltKeyword++;\n\t\t\tcontinue;\n\t\t}\n\n\t\taltProperties.withAltNonKeyword++;\n\t}\n\n\treturn altProperties;\n};\n\n/**\n * Checks the text for images, checks the type of each image and alt attributes for containing keywords\n *\n * @param {Paper} paper The paper to check for images.\n * @param {Researcher} researcher The researcher to use for analysis.\n *\n * @returns {object} Object containing all types of found images\n */\nexport default function( paper, researcher ) {\n\tconst topicForms = researcher.getResearch( \"morphology\" );\n\n\treturn matchAltProperties( imageInText( paper.getText() ), topicForms, paper.getLocale() );\n}\n"]}